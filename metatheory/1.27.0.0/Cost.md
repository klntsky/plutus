# Costs


This module contains the basic definitions and structures for modelling costs.

<pre class="Agda">
<a id="96" class="Keyword">module</a> <a id="103" href="Cost.html" class="Module">Cost</a> <a id="108" class="Keyword">where</a> 

</pre>
## Imports

<pre class="Agda"><a id="137" class="Keyword">open</a> <a id="142" class="Keyword">import</a> <a id="149" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a> <a id="167" class="Keyword">using</a> <a id="173" class="Symbol">(</a><a id="174" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="176" class="Symbol">)</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Function.html" class="Module">Function</a> <a id="199" class="Keyword">using</a> <a id="205" class="Symbol">(</a><a id="206" href="Function.Base.html#1040" class="Function Operator">_‚àò_</a><a id="209" class="Symbol">)</a>
<a id="211" class="Keyword">open</a> <a id="216" class="Keyword">import</a> <a id="223" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="233" class="Keyword">using</a> <a id="239" class="Symbol">(</a><a id="240" href="Data.Bool.Base.html#1292" class="Function Operator">if_then_else_</a><a id="253" class="Symbol">)</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="276" class="Keyword">using</a> <a id="282" class="Symbol">(</a><a id="283" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a><a id="286" class="Symbol">;</a><a id="287" href="Data.Fin.Base.html#1157" class="InductiveConstructor">zero</a><a id="291" class="Symbol">;</a><a id="292" href="Data.Fin.Base.html#1188" class="InductiveConstructor">suc</a><a id="295" class="Symbol">)</a>
<a id="297" class="Keyword">open</a> <a id="302" class="Keyword">import</a> <a id="309" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="318" class="Keyword">using</a> <a id="324" class="Symbol">(</a><a id="325" href="Agda.Builtin.Nat.html#203" class="Datatype">‚Ñï</a><a id="326" class="Symbol">;</a><a id="327" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="331" class="Symbol">;</a><a id="332" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a><a id="335" class="Symbol">;</a><a id="336" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">_+_</a><a id="339" class="Symbol">)</a>
<a id="341" class="Keyword">open</a> <a id="346" class="Keyword">import</a> <a id="353" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="373" class="Keyword">using</a> <a id="379" class="Symbol">(</a><a id="380" href="Data.Nat.Properties.html#13071" class="Function">+-assoc</a><a id="387" class="Symbol">;</a><a id="388" href="Data.Nat.Properties.html#13227" class="Function">+-identity ≥</a><a id="399" class="Symbol">)</a>
<a id="401" class="Keyword">open</a> <a id="406" class="Keyword">import</a> <a id="413" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="427" class="Keyword">using</a> <a id="433" class="Symbol">()</a> <a id="436" class="Keyword">renaming</a> <a id="445" class="Symbol">(</a><a id="446" href="Data.Nat.Show.html#1937" class="Function">show</a> <a id="451" class="Symbol">to</a> <a id="454" class="Function">show‚Ñï</a><a id="459" class="Symbol">)</a>
<a id="461" class="Keyword">open</a> <a id="466" class="Keyword">import</a> <a id="473" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="486" class="Keyword">using</a> <a id="492" class="Symbol">(</a><a id="493" href="Agda.Builtin.Int.html#245" class="Datatype">‚Ñ§</a><a id="494" class="Symbol">;</a><a id="495" href="Data.Integer.Base.html#1757" class="Function Operator">‚à£_‚à£</a><a id="498" class="Symbol">)</a>
<a id="500" class="Keyword">open</a> <a id="505" class="Keyword">import</a> <a id="512" href="Data.Float.html" class="Module">Data.Float</a> <a id="523" class="Keyword">using</a> <a id="529" class="Symbol">(</a><a id="530" href="Agda.Builtin.Float.html#353" class="Postulate">Float</a><a id="535" class="Symbol">;</a><a id="536" href="Agda.Builtin.Float.html#822" class="Primitive">from‚Ñï</a><a id="541" class="Symbol">;</a><a id="542" href="Agda.Builtin.Float.html#1500" class="Primitive">_√∑_</a><a id="545" class="Symbol">;</a><a id="546" href="Agda.Builtin.Float.html#421" class="Primitive">_‚â§·µá_</a><a id="550" class="Symbol">)</a> <a id="552" class="Keyword">renaming</a> <a id="561" class="Symbol">(</a><a id="562" href="Agda.Builtin.Float.html#1279" class="Primitive">show</a> <a id="567" class="Symbol">to</a> <a id="570" class="Primitive">showùîΩ</a><a id="575" class="Symbol">;</a><a id="576" href="Agda.Builtin.Float.html#1447" class="Primitive">_*_</a> <a id="580" class="Symbol">to</a> <a id="583" class="Primitive">_*f_</a><a id="587" class="Symbol">)</a>
<a id="589" class="Keyword">import</a> <a id="596" href="Data.List.html" class="Module">Data.List</a> <a id="606" class="Symbol">as</a> <a id="609" class="Module">L</a>

<a id="612" class="Keyword">open</a> <a id="617" class="Keyword">import</a> <a id="624" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="635" class="Keyword">using</a> <a id="641" class="Symbol">(</a><a id="642" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="647" class="Symbol">;</a><a id="648" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="652" class="Symbol">;</a><a id="653" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="660" class="Symbol">;</a><a id="661" href="Data.Maybe.Base.html#1563" class="Function">maybe‚Ä≤</a><a id="667" class="Symbol">;</a><a id="668" href="Data.Maybe.Base.html#1641" class="Function">fromMaybe</a><a id="677" class="Symbol">)</a> <a id="679" class="Keyword">renaming</a> <a id="688" class="Symbol">(</a><a id="689" href="Data.Maybe.Base.html#2029" class="Function">map</a> <a id="693" class="Symbol">to</a> <a id="696" class="Function">mapMaybe</a><a id="704" class="Symbol">;</a> <a id="706" href="Data.Maybe.Base.html#2236" class="Function Operator">_&gt;&gt;=_</a> <a id="712" class="Symbol">to</a> <a id="715" class="Function Operator">_&gt;&gt;=m_</a> <a id="722" class="Symbol">)</a>
<a id="724" class="Keyword">open</a> <a id="729" class="Keyword">import</a> <a id="736" href="Data.Product.html" class="Module">Data.Product</a> <a id="749" class="Keyword">using</a> <a id="755" class="Symbol">()</a> <a id="758" class="Keyword">renaming</a> <a id="767" class="Symbol">(</a><a id="768" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="772" class="Symbol">to</a> <a id="775" class="InductiveConstructor Operator">_,,_</a><a id="779" class="Symbol">)</a>
<a id="781" class="Keyword">open</a> <a id="786" class="Keyword">import</a> <a id="793" href="Data.String.html" class="Module">Data.String</a> <a id="805" class="Keyword">using</a> <a id="811" class="Symbol">(</a><a id="812" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="818" class="Symbol">;</a><a id="819" href="Data.String.Base.html#2375" class="Function Operator">_++_</a><a id="823" class="Symbol">;</a><a id="824" href="Data.String.Base.html#3567" class="Function">padLeft</a><a id="831" class="Symbol">;</a><a id="832" href="Data.String.Base.html#3686" class="Function">padRight</a><a id="840" class="Symbol">;</a><a id="841" href="Data.String.Base.html#2439" class="Function">length</a><a id="847" class="Symbol">)</a>
<a id="849" class="Keyword">open</a> <a id="854" class="Keyword">import</a> <a id="861" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="870" class="Keyword">using</a> <a id="876" class="Symbol">(</a><a id="877" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a><a id="880" class="Symbol">;</a><a id="881" href="Data.Vec.Base.html#5793" class="Function">replicate</a><a id="890" class="Symbol">;</a><a id="891" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a><a id="893" class="Symbol">;</a><a id="894" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">_‚à∑_</a><a id="897" class="Symbol">;</a><a id="898" href="Data.Vec.Base.html#4764" class="Function">foldr</a><a id="903" class="Symbol">)</a>
<a id="905" class="Keyword">open</a> <a id="910" class="Keyword">import</a> <a id="917" href="Algebra.html" class="Module">Algebra</a> <a id="925" class="Keyword">using</a> <a id="931" class="Symbol">(</a><a id="932" href="Algebra.Structures.html#2810" class="Record">IsMonoid</a><a id="940" class="Symbol">)</a>
<a id="942" class="Keyword">open</a> <a id="947" class="Keyword">import</a> <a id="954" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="971" class="Keyword">using</a> <a id="977" class="Symbol">(</a><a id="978" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a><a id="981" class="Symbol">;</a><a id="982" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a><a id="984" class="Symbol">)</a>
<a id="986" class="Keyword">open</a> <a id="991" class="Keyword">import</a> <a id="998" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1036" class="Keyword">using</a> <a id="1042" class="Symbol">(</a><a id="1043" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_‚â°_</a><a id="1046" class="Symbol">;</a><a id="1047" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="1051" class="Symbol">;</a><a id="1052" href="Relation.Binary.PropositionalEquality.Properties.html#3436" class="Function">isEquivalence</a><a id="1065" class="Symbol">;</a><a id="1066" href="Relation.Binary.PropositionalEquality.Core.html#1376" class="Function">cong‚ÇÇ</a><a id="1071" class="Symbol">)</a>
<a id="1073" class="Keyword">open</a> <a id="1078" class="Keyword">import</a> <a id="1085" href="Text.Printf.html" class="Module">Text.Printf</a> <a id="1097" class="Keyword">using</a> <a id="1103" class="Symbol">(</a><a id="1104" href="Text.Printf.html#1331" class="Function">printf</a><a id="1110" class="Symbol">)</a>
<a id="1112" class="Keyword">open</a> <a id="1117" class="Keyword">import</a> <a id="1124" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="1140" class="Keyword">using</a> <a id="1146" class="Symbol">(</a><a id="1147" href="Relation.Binary.Bundles.html#6937" class="Record">StrictTotalOrder</a><a id="1163" class="Symbol">)</a>
<a id="1165" class="Keyword">open</a> <a id="1170" class="Keyword">import</a> <a id="1177" href="Data.Char.html" class="Module">Data.Char</a> <a id="1187" class="Keyword">using</a> <a id="1193" class="Symbol">(</a><a id="1194" href="Data.Char.Base.html#1358" class="Function Operator">_‚âà·µá_</a><a id="1198" class="Symbol">)</a>
<a id="1200" class="Keyword">open</a> <a id="1205" class="Keyword">import</a> <a id="1212" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="1235" class="Keyword">using</a> <a id="1241" class="Symbol">(</a><a id="1242" href="Data.String.Properties.html#3207" class="Function">&lt;-strictTotalOrder-‚âà</a><a id="1262" class="Symbol">)</a>
<a id="1264" class="Keyword">open</a> <a id="1269" class="Keyword">import</a> <a id="1276" href="Data.Tree.AVL.Map.html" class="Module">Data.Tree.AVL.Map</a> <a id="1294" href="Data.String.Properties.html#3207" class="Function">&lt;-strictTotalOrder-‚âà</a> as <a id="AVL"></a><a id="1318" href="Cost.html#1318" class="Module">AVL</a> 
          <a id="1333" class="Keyword">using</a> <a id="1339" class="Symbol">(</a><a id="1340" href="Data.Tree.AVL.Map.html#1120" class="Function">Map</a><a id="1343" class="Symbol">;</a><a id="1344" href="Data.Tree.AVL.Map.html#1287" class="Function">empty</a><a id="1349" class="Symbol">;</a><a id="1350" href="Data.Tree.AVL.Map.html#2311" class="Function">unionWith</a><a id="1359" class="Symbol">;</a><a id="1360" href="Data.Tree.AVL.Map.html#1320" class="Function">singleton</a><a id="1369" class="Symbol">)</a> 
          <a id="1382" class="Keyword">renaming</a> <a id="1391" class="Symbol">(</a><a id="1392" href="Data.Tree.AVL.Map.html#1557" class="Function">lookup</a> <a id="1399" class="Symbol">to</a> <a id="1402" class="Function">lookupAVL</a><a id="1411" class="Symbol">)</a>

<a id="1414" class="Keyword">open</a> <a id="1419" class="Keyword">import</a> <a id="1426" href="Utils.html" class="Module">Utils</a> <a id="1432" class="Keyword">using</a> <a id="1438" class="Symbol">(</a><a id="1439" href="Utils.html#4708" class="Record Operator">_√ó_</a><a id="1442" class="Symbol">;</a><a id="1443" href="Utils.html#3971" class="InductiveConstructor Operator">_,_</a><a id="1446" class="Symbol">)</a>
<a id="1448" class="Keyword">open</a> <a id="1453" class="Keyword">import</a> <a id="1460" href="Builtin.html" class="Module">Builtin</a> <a id="1468" class="Keyword">using</a> <a id="1474" class="Symbol">(</a><a id="1475" href="Builtin.html#1212" class="Datatype">Builtin</a><a id="1482" class="Symbol">;</a><a id="1483" href="Builtin.html#26722" class="Function">showBuiltin</a><a id="1494" class="Symbol">;</a><a id="1495" href="Builtin.html#26870" class="Function">builtinList</a><a id="1506" class="Symbol">;</a><a id="1507" href="Builtin.html#14096" class="Function">arity</a><a id="1512" class="Symbol">)</a>
<a id="1514" class="Keyword">open</a> <a id="1519" href="Builtin.html#1212" class="Module">Builtin.Builtin</a>
<a id="1535" class="Keyword">open</a> <a id="1540" class="Keyword">import</a> <a id="1547" href="Builtin.Signature.html" class="Module">Builtin.Signature</a> <a id="1565" class="Keyword">using</a> <a id="1571" class="Symbol">(</a><a id="1572" href="Builtin.Signature.html#1830" class="Datatype Operator">_‚ä¢‚ôØ</a><a id="1575" class="Symbol">)</a>
<a id="1577" class="Keyword">open</a> <a id="1582" href="Builtin.Signature.html#1830" class="Module Operator">_‚ä¢‚ôØ</a>
<a id="1586" class="Keyword">open</a> <a id="1591" class="Keyword">import</a> <a id="1598" href="Builtin.Constant.AtomicType.html" class="Module">Builtin.Constant.AtomicType</a> <a id="1626" class="Keyword">using</a> <a id="1632" class="Symbol">(</a><a id="1633" href="Builtin.Constant.AtomicType.html#514" class="Datatype">AtomicTyCon</a><a id="1644" class="Symbol">)</a>
<a id="1646" class="Keyword">open</a> <a id="1651" href="Builtin.Constant.AtomicType.html#514" class="Module">AtomicTyCon</a>

<a id="1664" class="Keyword">open</a> <a id="1669" class="Keyword">import</a> <a id="1676" href="Cost.Base.html" class="Module">Cost.Base</a>
<a id="1686" class="Keyword">open</a> <a id="1691" class="Keyword">import</a> <a id="1698" href="Cost.Size.html" class="Module">Cost.Size</a> <a id="1708" class="Keyword">using</a> <a id="1714" class="Symbol">(</a><a id="1715" href="Cost.Size.html#3029" class="Function">defaultValueMeasure</a><a id="1734" class="Symbol">)</a>
<a id="1736" class="Keyword">open</a> <a id="1741" class="Keyword">import</a> <a id="1748" href="Cost.Model.html" class="Module">Cost.Model</a>
<a id="1759" class="Keyword">open</a> <a id="1764" class="Keyword">import</a> <a id="1771" href="Cost.Raw.html" class="Module">Cost.Raw</a>
<a id="1780" class="Keyword">open</a> <a id="1785" class="Keyword">import</a> <a id="1792" href="Untyped.CEK.html" class="Module">Untyped.CEK</a> <a id="1804" class="Keyword">using</a> <a id="1810" class="Symbol">(</a><a id="1811" href="Untyped.CEK.html#1224" class="Datatype">Value</a><a id="1816" class="Symbol">;</a><a id="1817" href="Untyped.CEK.html#1493" class="InductiveConstructor">V-con</a><a id="1822" class="Symbol">)</a>
</pre>
## Execution Budget

An execution budget consist of two costs: CPU and memory costs.

<pre class="Agda"><a id="1919" class="Keyword">record</a> <a id="ExBudget"></a><a id="1926" href="Cost.html#1926" class="Record">ExBudget</a> <a id="1935" class="Symbol">:</a> <a id="1937" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1941" class="Keyword">where</a>
  <a id="1949" class="Keyword">constructor</a> <a id="mkExBudget"></a><a id="1961" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> 
  <a id="1975" class="Keyword">field</a>
    <a id="ExBudget.ExCPU"></a><a id="1985" href="Cost.html#1985" class="Field">ExCPU</a> <a id="1991" class="Symbol">:</a> <a id="1993" href="Cost.Base.html#743" class="Function">CostingNat</a> <a id="2004" class="Comment">-- CPU usage</a>
    <a id="ExBudget.ExMem"></a><a id="2021" href="Cost.html#2021" class="Field">ExMem</a> <a id="2027" class="Symbol">:</a> <a id="2029" href="Cost.Base.html#743" class="Function">CostingNat</a> <a id="2040" class="Comment">-- Memory usage</a>

<a id="2057" class="Keyword">open</a> <a id="2062" href="Cost.html#1926" class="Module">ExBudget</a>

<a id="fromHExBudget"></a><a id="2072" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="2086" class="Symbol">:</a> <a id="2088" href="Cost.Raw.html#790" class="Postulate">HExBudget</a> <a id="2098" class="Symbol">‚Üí</a> <a id="2100" href="Cost.html#1926" class="Record">ExBudget</a> 
<a id="2110" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="2124" href="Cost.html#2124" class="Bound">hb</a> <a id="2127" class="Symbol">=</a> <a id="2129" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> <a id="2140" class="Symbol">(</a><a id="2141" href="Cost.Raw.html#2239" class="Postulate">getCPUCost</a> <a id="2152" href="Cost.html#2124" class="Bound">hb</a><a id="2154" class="Symbol">)</a> <a id="2156" class="Symbol">(</a><a id="2157" href="Cost.Raw.html#2285" class="Postulate">getMemoryCost</a> <a id="2171" href="Cost.html#2124" class="Bound">hb</a><a id="2173" class="Symbol">)</a>
</pre>
The type for execution budget should be a Monoid.
We show that this is the case for `ExBudget`.

<pre class="Agda"><a id="2281" class="Comment">-- unit of the monoid</a>
<a id="Œµ‚Ç¨"></a><a id="2303" href="Cost.html#2303" class="Function">Œµ‚Ç¨</a> <a id="2306" class="Symbol">:</a> <a id="2308" href="Cost.html#1926" class="Record">ExBudget</a> 
<a id="2318" href="Cost.html#2303" class="Function">Œµ‚Ç¨</a> <a id="2321" class="Symbol">=</a> <a id="2323" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> <a id="2334" class="Number">0</a> <a id="2336" class="Number">0</a> 

<a id="2340" class="Comment">-- binary operation</a>
<a id="_‚àô‚Ç¨_"></a><a id="2360" href="Cost.html#2360" class="Function Operator">_‚àô‚Ç¨_</a> <a id="2365" class="Symbol">:</a> <a id="2367" href="Cost.html#1926" class="Record">ExBudget</a> <a id="2376" class="Symbol">‚Üí</a> <a id="2378" href="Cost.html#1926" class="Record">ExBudget</a> <a id="2387" class="Symbol">‚Üí</a> <a id="2389" href="Cost.html#1926" class="Record">ExBudget</a> 
<a id="2399" class="Symbol">(</a><a id="2400" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> <a id="2411" href="Cost.html#2411" class="Bound">xCPU</a> <a id="2416" href="Cost.html#2416" class="Bound">xMem</a><a id="2420" class="Symbol">)</a> <a id="2422" href="Cost.html#2360" class="Function Operator">‚àô‚Ç¨</a> <a id="2425" class="Symbol">(</a><a id="2426" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> <a id="2437" href="Cost.html#2437" class="Bound">yCPU</a> <a id="2442" href="Cost.html#2442" class="Bound">yMem</a><a id="2446" class="Symbol">)</a> <a id="2448" class="Symbol">=</a> <a id="2450" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> <a id="2461" class="Symbol">(</a><a id="2462" href="Cost.html#2411" class="Bound">xCPU</a> <a id="2467" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="2469" href="Cost.html#2437" class="Bound">yCPU</a><a id="2473" class="Symbol">)</a> <a id="2475" class="Symbol">(</a><a id="2476" href="Cost.html#2416" class="Bound">xMem</a> <a id="2481" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="2483" href="Cost.html#2442" class="Bound">yMem</a><a id="2487" class="Symbol">)</a>

<a id="2490" class="Comment">-- Note: working with `Monoid` instances would imply working in Set‚ÇÅ, so we avoid it</a>
<a id="2575" class="Comment">-- and just state that `ExBudget` is a Monoid</a>

<a id="isMonoidExBudget"></a><a id="2622" href="Cost.html#2622" class="Function">isMonoidExBudget</a> <a id="2639" class="Symbol">:</a> <a id="2641" href="Algebra.Structures.html#2810" class="Record">IsMonoid</a> <a id="2650" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_‚â°_</a> <a id="2654" href="Cost.html#2360" class="Function Operator">_‚àô‚Ç¨_</a> <a id="2659" href="Cost.html#2303" class="Function">Œµ‚Ç¨</a>
<a id="2662" href="Cost.html#2622" class="Function">isMonoidExBudget</a> <a id="2679" class="Symbol">=</a> <a id="2681" class="Keyword">record</a> <a id="2688" class="Symbol">{</a> 
       <a id="2698" href="Algebra.Structures.html#2871" class="Field">isSemigroup</a> <a id="2710" class="Symbol">=</a> <a id="2712" class="Keyword">record</a> <a id="2719" class="Symbol">{</a> 
           <a id="2733" href="Algebra.Structures.html#1852" class="Field">isMagma</a> <a id="2741" class="Symbol">=</a> <a id="2743" class="Keyword">record</a> <a id="2750" class="Symbol">{</a> <a id="2752" href="Algebra.Structures.html#1181" class="Field">isEquivalence</a> <a id="2766" class="Symbol">=</a> <a id="2768" href="Relation.Binary.PropositionalEquality.Properties.html#3436" class="Function">isEquivalence</a> <a id="2782" class="Symbol">;</a> <a id="2784" href="Algebra.Structures.html#1219" class="Field">‚àô-cong</a> <a id="2791" class="Symbol">=</a> <a id="2793" class="Symbol">Œª</a> <a id="2795" class="Symbol">{</a><a id="2796" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2801" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2806" class="Symbol">‚Üí</a> <a id="2808" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2813" class="Symbol">}}</a> 
           <a id="2828" class="Symbol">;</a> <a id="2830" href="Algebra.Structures.html#1876" class="Field">assoc</a> <a id="2836" class="Symbol">=</a> <a id="2838" class="Symbol">Œª</a> <a id="2840" href="Cost.html#2840" class="Bound">x</a> <a id="2842" href="Cost.html#2842" class="Bound">y</a> <a id="2844" href="Cost.html#2844" class="Bound">z</a> <a id="2846" class="Symbol">‚Üí</a> <a id="2848" href="Relation.Binary.PropositionalEquality.Core.html#1376" class="Function">cong‚ÇÇ</a> <a id="2854" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> <a id="2865" class="Symbol">(</a><a id="2866" href="Data.Nat.Properties.html#13071" class="Function">+-assoc</a> <a id="2874" class="Symbol">(</a><a id="2875" href="Cost.html#1985" class="Field">ExCPU</a> <a id="2881" href="Cost.html#2840" class="Bound">x</a><a id="2882" class="Symbol">)</a> <a id="2884" class="Symbol">(</a><a id="2885" href="Cost.html#1985" class="Field">ExCPU</a> <a id="2891" href="Cost.html#2842" class="Bound">y</a><a id="2892" class="Symbol">)</a> <a id="2894" class="Symbol">(</a><a id="2895" href="Cost.html#1985" class="Field">ExCPU</a> <a id="2901" href="Cost.html#2844" class="Bound">z</a><a id="2902" class="Symbol">))</a> 
                                                <a id="2954" class="Symbol">(</a><a id="2955" href="Data.Nat.Properties.html#13071" class="Function">+-assoc</a> <a id="2963" class="Symbol">(</a><a id="2964" href="Cost.html#2021" class="Field">ExMem</a> <a id="2970" href="Cost.html#2840" class="Bound">x</a><a id="2971" class="Symbol">)</a> <a id="2973" class="Symbol">(</a><a id="2974" href="Cost.html#2021" class="Field">ExMem</a> <a id="2980" href="Cost.html#2842" class="Bound">y</a><a id="2981" class="Symbol">)</a> <a id="2983" class="Symbol">(</a><a id="2984" href="Cost.html#2021" class="Field">ExMem</a> <a id="2990" href="Cost.html#2844" class="Bound">z</a><a id="2991" class="Symbol">))</a> <a id="2994" class="Symbol">}</a> 
     <a id="3002" class="Symbol">;</a> <a id="3004" href="Algebra.Structures.html#2903" class="Field">identity</a> <a id="3013" class="Symbol">=</a> <a id="3015" class="Symbol">(Œª</a> <a id="3018" href="Cost.html#3018" class="Bound">x</a> <a id="3020" class="Symbol">‚Üí</a> <a id="3022" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="3026" class="Symbol">)</a> <a id="3028" href="Cost.html#775" class="InductiveConstructor Operator">,,</a> <a id="3031" class="Symbol">Œª</a> <a id="3033" href="Cost.html#3033" class="Bound">x</a> <a id="3035" class="Symbol">‚Üí</a> <a id="3037" href="Relation.Binary.PropositionalEquality.Core.html#1376" class="Function">cong‚ÇÇ</a> <a id="3043" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> <a id="3054" class="Symbol">(</a><a id="3055" href="Data.Nat.Properties.html#13227" class="Function">+-identity ≥</a> <a id="3067" class="Symbol">(</a><a id="3068" href="Cost.html#1985" class="Field">ExCPU</a> <a id="3074" href="Cost.html#3033" class="Bound">x</a><a id="3075" class="Symbol">))</a> <a id="3078" class="Symbol">(</a><a id="3079" href="Data.Nat.Properties.html#13227" class="Function">+-identity ≥</a> <a id="3091" class="Symbol">(</a><a id="3092" href="Cost.html#2021" class="Field">ExMem</a> <a id="3098" href="Cost.html#3033" class="Bound">x</a><a id="3099" class="Symbol">))</a> <a id="3102" class="Symbol">}</a>
</pre>
## Cost of executing a builtin

To calculate the cost of a builtin we obtain the corresponding builtin model, 
and run the cpu and memory model using the vector of argument sizes.

<pre class="Agda"><a id="builtinCost"></a><a id="3295" href="Cost.html#3295" class="Function">builtinCost</a> <a id="3307" class="Symbol">:</a> <a id="3309" class="Symbol">(</a><a id="3310" href="Cost.html#3310" class="Bound">b</a> <a id="3312" class="Symbol">:</a> <a id="3314" href="Builtin.html#1212" class="Datatype">Builtin</a><a id="3321" class="Symbol">)</a> <a id="3323" class="Symbol">‚Üí</a> <a id="3325" href="Cost.Model.html#2897" class="Record">BuiltinModel</a> <a id="3338" class="Symbol">(</a><a id="3339" href="Builtin.html#14096" class="Function">arity</a> <a id="3345" href="Cost.html#3310" class="Bound">b</a><a id="3346" class="Symbol">)</a> <a id="3348" class="Symbol">‚Üí</a> <a id="3350" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="3354" href="Untyped.CEK.html#1224" class="Datatype">Value</a> <a id="3360" class="Symbol">(</a><a id="3361" href="Builtin.html#14096" class="Function">arity</a> <a id="3367" href="Cost.html#3310" class="Bound">b</a><a id="3368" class="Symbol">)</a> <a id="3370" class="Symbol">‚Üí</a> <a id="3372" href="Cost.html#1926" class="Record">ExBudget</a>
<a id="3381" href="Cost.html#3295" class="Function">builtinCost</a> <a id="3393" href="Cost.html#3393" class="Bound">b</a> <a id="3395" href="Cost.html#3395" class="Bound">bc</a> <a id="3398" href="Cost.html#3398" class="Bound">cs</a> <a id="3401" class="Symbol">=</a> <a id="3403" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> <a id="3414" class="Symbol">(</a><a id="3415" href="Cost.Model.html#3318" class="Function">runModel</a> <a id="3424" class="Symbol">(</a><a id="3425" href="Cost.Model.html#2949" class="Field">costingCPU</a> <a id="3436" href="Cost.html#3395" class="Bound">bc</a><a id="3438" class="Symbol">)</a> <a id="3440" href="Cost.html#3398" class="Bound">cs</a><a id="3442" class="Symbol">)</a> <a id="3444" class="Symbol">(</a><a id="3445" href="Cost.Model.html#3318" class="Function">runModel</a> <a id="3454" class="Symbol">(</a><a id="3455" href="Cost.Model.html#2960" class="Field">costingMem</a> <a id="3466" href="Cost.html#3395" class="Bound">bc</a><a id="3468" class="Symbol">)</a> <a id="3470" href="Cost.html#3398" class="Bound">cs</a><a id="3472" class="Symbol">)</a>
</pre>

## Default Machine Parameters

The machine parameters for `ExBudget` for a given Cost Model

<pre class="Agda"><a id="CostModel"></a><a id="3578" href="Cost.html#3578" class="Function">CostModel</a> <a id="3588" class="Symbol">=</a> <a id="3590" href="Cost.Raw.html#757" class="Postulate">HCekMachineCosts</a> <a id="3607" href="Utils.html#4708" class="Record Operator">√ó</a> <a id="3609" href="Cost.Model.html#8370" class="Function">ModelAssignment</a>

<a id="cekMachineCostFunction"></a><a id="3626" href="Cost.html#3626" class="Function">cekMachineCostFunction</a> <a id="3649" class="Symbol">:</a> <a id="3651" href="Cost.Raw.html#757" class="Postulate">HCekMachineCosts</a> <a id="3668" class="Symbol">‚Üí</a> <a id="3670" href="Cost.Base.html#864" class="Datatype">StepKind</a> <a id="3679" class="Symbol">‚Üí</a> <a id="3681" href="Cost.html#1926" class="Record">ExBudget</a>
<a id="3690" href="Cost.html#3626" class="Function">cekMachineCostFunction</a> <a id="3713" href="Cost.html#3713" class="Bound">mc</a> <a id="3716" href="Cost.Base.html#890" class="InductiveConstructor">BConst</a> <a id="3723" class="Symbol">=</a> <a id="3725" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="3739" class="Symbol">(</a><a id="3740" href="Cost.Raw.html#1057" class="Postulate">getCekConstCost</a> <a id="3756" href="Cost.html#3713" class="Bound">mc</a><a id="3758" class="Symbol">)</a>
<a id="3760" href="Cost.html#3626" class="Function">cekMachineCostFunction</a> <a id="3783" href="Cost.html#3783" class="Bound">mc</a> <a id="3786" href="Cost.Base.html#904" class="InductiveConstructor">BVar</a> <a id="3791" class="Symbol">=</a> <a id="3793" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="3807" class="Symbol">(</a><a id="3808" href="Cost.Raw.html#997" class="Postulate">getCekVarCost</a> <a id="3822" href="Cost.html#3783" class="Bound">mc</a><a id="3824" class="Symbol">)</a>
<a id="3826" href="Cost.html#3626" class="Function">cekMachineCostFunction</a> <a id="3849" href="Cost.html#3849" class="Bound">mc</a> <a id="3852" href="Cost.Base.html#915" class="InductiveConstructor">BLamAbs</a> <a id="3860" class="Symbol">=</a> <a id="3862" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="3876" class="Symbol">(</a><a id="3877" href="Cost.Raw.html#1117" class="Postulate">getCekLamCost</a> <a id="3891" href="Cost.html#3849" class="Bound">mc</a><a id="3893" class="Symbol">)</a>
<a id="3895" href="Cost.html#3626" class="Function">cekMachineCostFunction</a> <a id="3918" href="Cost.html#3918" class="Bound">mc</a> <a id="3921" href="Cost.Base.html#929" class="InductiveConstructor">BApply</a> <a id="3928" class="Symbol">=</a> <a id="3930" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="3944" class="Symbol">(</a><a id="3945" href="Cost.Raw.html#1297" class="Postulate">getCekApplyCost</a> <a id="3961" href="Cost.html#3918" class="Bound">mc</a><a id="3963" class="Symbol">)</a>
<a id="3965" href="Cost.html#3626" class="Function">cekMachineCostFunction</a> <a id="3988" href="Cost.html#3988" class="Bound">mc</a> <a id="3991" href="Cost.Base.html#942" class="InductiveConstructor">BDelay</a> <a id="3998" class="Symbol">=</a> <a id="4000" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="4014" class="Symbol">(</a><a id="4015" href="Cost.Raw.html#1177" class="Postulate">getCekDelayCost</a> <a id="4031" href="Cost.html#3988" class="Bound">mc</a><a id="4033" class="Symbol">)</a>
<a id="4035" href="Cost.html#3626" class="Function">cekMachineCostFunction</a> <a id="4058" href="Cost.html#4058" class="Bound">mc</a> <a id="4061" href="Cost.Base.html#955" class="InductiveConstructor">BForce</a> <a id="4068" class="Symbol">=</a> <a id="4070" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="4084" class="Symbol">(</a><a id="4085" href="Cost.Raw.html#1237" class="Postulate">getCekForceCost</a> <a id="4101" href="Cost.html#4058" class="Bound">mc</a><a id="4103" class="Symbol">)</a>
<a id="4105" href="Cost.html#3626" class="Function">cekMachineCostFunction</a> <a id="4128" href="Cost.html#4128" class="Bound">mc</a> <a id="4131" href="Cost.Base.html#968" class="InductiveConstructor">BBuiltin</a> <a id="4140" class="Symbol">=</a> <a id="4142" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="4156" class="Symbol">(</a><a id="4157" href="Cost.Raw.html#1357" class="Postulate">getCekBuiltinCost</a> <a id="4175" href="Cost.html#4128" class="Bound">mc</a><a id="4177" class="Symbol">)</a>
<a id="4179" href="Cost.html#3626" class="Function">cekMachineCostFunction</a> <a id="4202" href="Cost.html#4202" class="Bound">mc</a> <a id="4205" href="Cost.Base.html#1049" class="InductiveConstructor">BConstr</a> <a id="4213" class="Symbol">=</a> <a id="4215" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="4229" class="Symbol">(</a><a id="4230" href="Cost.Raw.html#1057" class="Postulate">getCekConstCost</a> <a id="4246" href="Cost.html#4202" class="Bound">mc</a><a id="4248" class="Symbol">)</a>
<a id="4250" href="Cost.html#3626" class="Function">cekMachineCostFunction</a> <a id="4273" href="Cost.html#4273" class="Bound">mc</a> <a id="4276" href="Cost.Base.html#1064" class="InductiveConstructor">BCase</a> <a id="4282" class="Symbol">=</a> <a id="4284" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="4298" class="Symbol">(</a><a id="4299" href="Cost.Raw.html#1477" class="Postulate">getCekCaseCost</a> <a id="4314" href="Cost.html#4273" class="Bound">mc</a><a id="4316" class="Symbol">)</a>

<a id="exBudgetCategoryCost"></a><a id="4319" href="Cost.html#4319" class="Function">exBudgetCategoryCost</a> <a id="4340" class="Symbol">:</a> <a id="4342" href="Cost.html#3578" class="Function">CostModel</a> <a id="4352" class="Symbol">‚Üí</a> <a id="4354" href="Cost.Base.html#1613" class="Datatype">ExBudgetCategory</a> <a id="4371" class="Symbol">‚Üí</a> <a id="4373" href="Cost.html#1926" class="Record">ExBudget</a> 
<a id="4383" href="Cost.html#4319" class="Function">exBudgetCategoryCost</a> <a id="4404" class="Symbol">(</a><a id="4405" href="Cost.html#4405" class="Bound">cekMc</a> <a id="4411" href="Utils.html#4752" class="InductiveConstructor Operator">,</a> <a id="4413" class="Symbol">_)</a> <a id="4416" class="Symbol">(</a><a id="4417" href="Cost.Base.html#1689" class="InductiveConstructor">BStep</a> <a id="4423" href="Cost.html#4423" class="Bound">x</a><a id="4424" class="Symbol">)</a> <a id="4426" class="Symbol">=</a> <a id="4428" href="Cost.html#3626" class="Function">cekMachineCostFunction</a> <a id="4451" href="Cost.html#4405" class="Bound">cekMc</a> <a id="4457" href="Cost.html#4423" class="Bound">x</a>
<a id="4459" href="Cost.html#4319" class="Function">exBudgetCategoryCost</a> <a id="4480" class="Symbol">(_</a> <a id="4483" href="Utils.html#4752" class="InductiveConstructor Operator">,</a> <a id="4485" href="Cost.html#4485" class="Bound">ma</a><a id="4487" class="Symbol">)</a> <a id="4489" class="Symbol">(</a><a id="4490" href="Cost.Base.html#1796" class="InductiveConstructor">BBuiltinApp</a> <a id="4502" href="Cost.html#4502" class="Bound">b</a> <a id="4504" href="Cost.html#4504" class="Bound">cs</a><a id="4506" class="Symbol">)</a> <a id="4508" class="Symbol">=</a> <a id="4510" href="Cost.html#3295" class="Function">builtinCost</a> <a id="4522" href="Cost.html#4502" class="Bound">b</a> <a id="4524" class="Symbol">(</a><a id="4525" href="Cost.html#4485" class="Bound">ma</a> <a id="4528" href="Cost.html#4502" class="Bound">b</a><a id="4529" class="Symbol">)</a> <a id="4531" href="Cost.html#4504" class="Bound">cs</a>
<a id="4534" href="Cost.html#4319" class="Function">exBudgetCategoryCost</a> <a id="4555" class="Symbol">(</a><a id="4556" href="Cost.html#4556" class="Bound">cekMc</a> <a id="4562" href="Utils.html#4752" class="InductiveConstructor Operator">,</a> <a id="4564" class="Symbol">_)</a> <a id="4567" href="Cost.Base.html#1892" class="InductiveConstructor">BStartup</a> <a id="4576" class="Symbol">=</a> <a id="4578" href="Cost.html#2072" class="Function">fromHExBudget</a> <a id="4592" class="Symbol">(</a><a id="4593" href="Cost.Raw.html#937" class="Postulate">getCekStartupCost</a> <a id="4611" href="Cost.html#4556" class="Bound">cekMc</a><a id="4616" class="Symbol">)</a>

<a id="machineParameters"></a><a id="4619" href="Cost.html#4619" class="Function">machineParameters</a> <a id="4637" class="Symbol">:</a> <a id="4639" href="Cost.html#3578" class="Function">CostModel</a> <a id="4649" class="Symbol">‚Üí</a> <a id="4651" href="Cost.Base.html#2033" class="Record">MachineParameters</a> <a id="4669" href="Cost.html#1926" class="Record">ExBudget</a>
<a id="4678" href="Cost.html#4619" class="Function">machineParameters</a> <a id="4696" href="Cost.html#4696" class="Bound">costmodel</a> <a id="4706" class="Symbol">=</a> <a id="4708" class="Keyword">record</a> <a id="4715" class="Symbol">{</a>
    <a id="4721" href="Cost.Base.html#2092" class="Field">cekMachineCost</a> <a id="4736" class="Symbol">=</a> <a id="4738" href="Cost.html#4319" class="Function">exBudgetCategoryCost</a> <a id="4759" href="Cost.html#4696" class="Bound">costmodel</a>
  <a id="4771" class="Symbol">;</a> <a id="4773" href="Cost.Base.html#2139" class="Field">Œµ</a> <a id="4775" class="Symbol">=</a> <a id="4777" href="Cost.html#2303" class="Function">Œµ‚Ç¨</a>
  <a id="4782" class="Symbol">;</a> <a id="4784" href="Cost.Base.html#2154" class="Field Operator">_‚àô_</a> <a id="4788" class="Symbol">=</a> <a id="4790" href="Cost.html#2360" class="Function Operator">_‚àô‚Ç¨_</a>
  <a id="4797" class="Symbol">;</a> <a id="4799" href="Cost.Base.html#2185" class="Field">costMonoid</a> <a id="4810" class="Symbol">=</a> <a id="4812" href="Cost.html#2622" class="Function">isMonoidExBudget</a>
 <a id="4830" class="Symbol">}</a> 

<a id="countingReport"></a><a id="4834" href="Cost.html#4834" class="Function">countingReport</a> <a id="4849" class="Symbol">:</a> <a id="4851" href="Cost.html#1926" class="Record">ExBudget</a> <a id="4860" class="Symbol">‚Üí</a> <a id="4862" href="Agda.Builtin.String.html#335" class="Postulate">String</a> 
<a id="4870" href="Cost.html#4834" class="Function">countingReport</a> <a id="4885" class="Symbol">(</a><a id="4886" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> <a id="4897" href="Cost.html#4897" class="Bound">cpu</a> <a id="4901" href="Cost.html#4901" class="Bound">mem</a><a id="4904" class="Symbol">)</a> <a id="4906" class="Symbol">=</a> 
      <a id="4915" class="String">&quot;\nCPU budget:    &quot;</a> <a id="4935" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="4938" href="Cost.html#454" class="Function">show‚Ñï</a> <a id="4944" href="Cost.html#4897" class="Bound">cpu</a> 
   <a id="4952" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="4955" class="String">&quot;\nMemory budget: &quot;</a> <a id="4975" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="4978" href="Cost.html#454" class="Function">show‚Ñï</a> <a id="4984" href="Cost.html#4901" class="Bound">mem</a>
</pre> ## Tallying budget 

These functions define a type for Budgets that can record detailed cost information
about nodes and builtins.

We need a map from `ExBudgetCategory` into `ExBudget`. 
It's not the most efficient, but the simplest thing to do is to 
transform `ExBudgetCategory` into a string, and use that as keys.

<pre class="Agda"><a id="mkKeyFromExBudgetCategory"></a><a id="5317" href="Cost.html#5317" class="Function">mkKeyFromExBudgetCategory</a> <a id="5343" class="Symbol">:</a> <a id="5345" href="Cost.Base.html#1613" class="Datatype">ExBudgetCategory</a> <a id="5362" class="Symbol">‚Üí</a> <a id="5364" href="Agda.Builtin.String.html#335" class="Postulate">String</a> 
<a id="5372" href="Cost.html#5317" class="Function">mkKeyFromExBudgetCategory</a> <a id="5398" class="Symbol">(</a><a id="5399" href="Cost.Base.html#1689" class="InductiveConstructor">BStep</a> <a id="5405" href="Cost.html#5405" class="Bound">x</a><a id="5406" class="Symbol">)</a> <a id="5408" class="Symbol">=</a> <a id="5410" class="String">&quot;0&quot;</a> <a id="5414" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="5417" href="Cost.Base.html#1234" class="Function">showStepKind</a> <a id="5430" href="Cost.html#5405" class="Bound">x</a>
<a id="5432" href="Cost.html#5317" class="Function">mkKeyFromExBudgetCategory</a> <a id="5458" class="Symbol">(</a><a id="5459" href="Cost.Base.html#1796" class="InductiveConstructor">BBuiltinApp</a> <a id="5471" href="Cost.html#5471" class="Bound">x</a> <a id="5473" class="Symbol">_)</a> <a id="5476" class="Symbol">=</a> <a id="5478" class="String">&quot;1&quot;</a><a id="5481" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="5484" href="Builtin.html#26722" class="Function">showBuiltin</a> <a id="5496" href="Cost.html#5471" class="Bound">x</a>
<a id="5498" href="Cost.html#5317" class="Function">mkKeyFromExBudgetCategory</a> <a id="5524" href="Cost.Base.html#1892" class="InductiveConstructor">BStartup</a> <a id="5533" class="Symbol">=</a> <a id="5535" class="String">&quot;2&quot;</a>

<a id="TallyingBudget"></a><a id="5540" href="Cost.html#5540" class="Function">TallyingBudget</a> <a id="5555" class="Symbol">:</a> <a id="5557" href="Agda.Primitive.html#388" class="Primitive">Set</a> 
<a id="5562" href="Cost.html#5540" class="Function">TallyingBudget</a> <a id="5577" class="Symbol">=</a> <a id="5579" href="Data.Tree.AVL.Map.html#1120" class="Function">Map</a> <a id="5583" href="Cost.html#1926" class="Record">ExBudget</a> <a id="5592" href="Utils.html#4708" class="Record Operator">√ó</a> <a id="5594" href="Cost.html#1926" class="Record">ExBudget</a>

<a id="lookup"></a><a id="5604" href="Cost.html#5604" class="Function">lookup</a> <a id="5611" class="Symbol">:</a> <a id="5613" href="Data.Tree.AVL.Map.html#1120" class="Function">Map</a> <a id="5617" href="Cost.html#1926" class="Record">ExBudget</a> <a id="5626" class="Symbol">‚Üí</a> <a id="5628" href="Cost.Base.html#1613" class="Datatype">ExBudgetCategory</a> <a id="5645" class="Symbol">‚Üí</a> <a id="5647" href="Cost.html#1926" class="Record">ExBudget</a>
<a id="5656" href="Cost.html#5604" class="Function">lookup</a> <a id="5663" href="Cost.html#5663" class="Bound">m</a> <a id="5665" href="Cost.html#5665" class="Bound">k</a> <a id="5667" class="Keyword">with</a> <a id="5672" href="Cost.html#1402" class="Function">lookupAVL</a> <a id="5682" class="Symbol">(</a><a id="5683" href="Cost.html#5317" class="Function">mkKeyFromExBudgetCategory</a> <a id="5709" href="Cost.html#5665" class="Bound">k</a><a id="5710" class="Symbol">)</a> <a id="5712" href="Cost.html#5663" class="Bound">m</a> 
<a id="5715" class="Symbol">...</a> <a id="5719" class="Symbol">|</a> <a id="5721" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5726" href="Cost.html#5726" class="Bound">x</a> <a id="5728" class="Symbol">=</a> <a id="5730" href="Cost.html#5726" class="Bound">x</a>
<a id="5732" class="Symbol">...</a> <a id="5736" class="Symbol">|</a> <a id="5738" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5746" class="Symbol">=</a> <a id="5748" href="Cost.html#2303" class="Function">Œµ‚Ç¨</a>
</pre>
As required, `TallyingBudget` is a monoid. 

<pre class="Agda"><a id="5805" class="Comment">--unit of TallyingBudget </a>
<a id="ŒµT"></a><a id="5831" href="Cost.html#5831" class="Function">ŒµT</a> <a id="5834" class="Symbol">:</a> <a id="5836" href="Cost.html#5540" class="Function">TallyingBudget</a>
<a id="5851" href="Cost.html#5831" class="Function">ŒµT</a> <a id="5854" class="Symbol">=</a> <a id="5856" href="Data.Tree.AVL.Map.html#1287" class="Function">empty</a> <a id="5862" href="Utils.html#4752" class="InductiveConstructor Operator">,</a> <a id="5864" href="Cost.html#2303" class="Function">Œµ‚Ç¨</a>

<a id="5868" class="Comment">-- adding TallyingBudgets</a>
<a id="_‚àôT_"></a><a id="5894" href="Cost.html#5894" class="Function Operator">_‚àôT_</a> <a id="5899" class="Symbol">:</a> <a id="5901" href="Cost.html#5540" class="Function">TallyingBudget</a> <a id="5916" class="Symbol">‚Üí</a> <a id="5918" href="Cost.html#5540" class="Function">TallyingBudget</a> <a id="5933" class="Symbol">‚Üí</a> <a id="5935" href="Cost.html#5540" class="Function">TallyingBudget</a>
<a id="5950" class="Symbol">(</a><a id="5951" href="Cost.html#5951" class="Bound">m</a> <a id="5953" href="Utils.html#4752" class="InductiveConstructor Operator">,</a> <a id="5955" href="Cost.html#5955" class="Bound">x</a><a id="5956" class="Symbol">)</a> <a id="5958" href="Cost.html#5894" class="Function Operator">‚àôT</a> <a id="5961" class="Symbol">(</a><a id="5962" href="Cost.html#5962" class="Bound">n</a> <a id="5964" href="Utils.html#4752" class="InductiveConstructor Operator">,</a> <a id="5966" href="Cost.html#5966" class="Bound">y</a><a id="5967" class="Symbol">)</a> <a id="5969" class="Symbol">=</a> <a id="5971" href="Data.Tree.AVL.Map.html#2311" class="Function">unionWith</a> <a id="5981" href="Cost.html#6007" class="Function">u</a> <a id="5983" href="Cost.html#5951" class="Bound">m</a> <a id="5985" href="Cost.html#5962" class="Bound">n</a> <a id="5987" href="Utils.html#4752" class="InductiveConstructor Operator">,</a> <a id="5989" class="Symbol">(</a><a id="5990" href="Cost.html#5955" class="Bound">x</a> <a id="5992" href="Cost.html#2360" class="Function Operator">‚àô‚Ç¨</a> <a id="5995" href="Cost.html#5966" class="Bound">y</a><a id="5996" class="Symbol">)</a>
   <a id="6001" class="Keyword">where</a> <a id="6007" href="Cost.html#6007" class="Function">u</a> <a id="6009" class="Symbol">:</a> <a id="6011" href="Cost.html#1926" class="Record">ExBudget</a> <a id="6020" class="Symbol">‚Üí</a> <a id="6022" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6028" class="Symbol">(</a><a id="6029" href="Cost.html#1926" class="Record">ExBudget</a><a id="6037" class="Symbol">)</a> <a id="6039" class="Symbol">‚Üí</a> <a id="6041" href="Cost.html#1926" class="Record">ExBudget</a>
         <a id="6059" href="Cost.html#6007" class="Function">u</a> <a id="6061" href="Cost.html#6061" class="Bound">x</a> <a id="6063" class="Symbol">(</a><a id="6064" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6069" href="Cost.html#6069" class="Bound">y</a><a id="6070" class="Symbol">)</a> <a id="6072" class="Symbol">=</a> <a id="6074" href="Cost.html#6061" class="Bound">x</a> <a id="6076" href="Cost.html#2360" class="Function Operator">‚àô‚Ç¨</a> <a id="6079" href="Cost.html#6069" class="Bound">y</a>
         <a id="6090" href="Cost.html#6007" class="Function">u</a> <a id="6092" href="Cost.html#6092" class="Bound">x</a> <a id="6094" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6102" class="Symbol">=</a> <a id="6104" href="Cost.html#6092" class="Bound">x</a>

<a id="6107" class="Comment">-- TODO : Prove these postulates.</a>
<a id="6141" class="Keyword">postulate</a> <a id="TallyingBudget-assoc"></a><a id="6151" href="Cost.html#6151" class="Postulate">TallyingBudget-assoc</a> <a id="6172" class="Symbol">:</a> <a id="6174" href="Algebra.Definitions.html#1117" class="Function">Algebra.Associative</a> <a id="6194" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_‚â°_</a> <a id="6198" href="Cost.html#5894" class="Function Operator">_‚àôT_</a>
<a id="6203" class="Keyword">postulate</a> <a id="Tallying-budget-identity ≥"></a><a id="6213" href="Cost.html#6213" class="Postulate">Tallying-budget-identity ≥</a> <a id="6239" class="Symbol">:</a> <a id="6241" href="Algebra.Definitions.html#1350" class="Function">Algebra.RightIdentity</a> <a id="6263" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_‚â°_</a> <a id="6267" href="Cost.html#5831" class="Function">ŒµT</a> <a id="6270" href="Cost.html#5894" class="Function Operator">_‚àôT_</a>

<a id="isMonoidTallyingBudget"></a><a id="6276" href="Cost.html#6276" class="Function">isMonoidTallyingBudget</a> <a id="6299" class="Symbol">:</a> <a id="6301" href="Algebra.Structures.html#2810" class="Record">IsMonoid</a> <a id="6310" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_‚â°_</a> <a id="6314" href="Cost.html#5894" class="Function Operator">_‚àôT_</a> <a id="6319" href="Cost.html#5831" class="Function">ŒµT</a>
<a id="6322" href="Cost.html#6276" class="Function">isMonoidTallyingBudget</a> <a id="6345" class="Symbol">=</a> <a id="6347" class="Keyword">record</a> <a id="6354" class="Symbol">{</a> 
       <a id="6364" href="Algebra.Structures.html#2871" class="Field">isSemigroup</a> <a id="6376" class="Symbol">=</a> <a id="6378" class="Keyword">record</a> <a id="6385" class="Symbol">{</a> 
           <a id="6399" href="Algebra.Structures.html#1852" class="Field">isMagma</a> <a id="6407" class="Symbol">=</a> <a id="6409" class="Keyword">record</a> <a id="6416" class="Symbol">{</a> <a id="6418" href="Algebra.Structures.html#1181" class="Field">isEquivalence</a> <a id="6432" class="Symbol">=</a> <a id="6434" href="Relation.Binary.PropositionalEquality.Properties.html#3436" class="Function">isEquivalence</a> 
                            <a id="6477" class="Symbol">;</a> <a id="6479" href="Algebra.Structures.html#1219" class="Field">‚àô-cong</a> <a id="6486" class="Symbol">=</a> <a id="6488" class="Symbol">Œª</a> <a id="6490" class="Symbol">{</a><a id="6491" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6496" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6501" class="Symbol">‚Üí</a> <a id="6503" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6508" class="Symbol">}}</a> 
           <a id="6523" class="Symbol">;</a> <a id="6525" href="Algebra.Structures.html#1876" class="Field">assoc</a> <a id="6531" class="Symbol">=</a> <a id="6533" href="Cost.html#6151" class="Postulate">TallyingBudget-assoc</a> <a id="6554" class="Symbol">}</a> 
     <a id="6562" class="Symbol">;</a> <a id="6564" href="Algebra.Structures.html#2903" class="Field">identity</a> <a id="6573" class="Symbol">=</a> <a id="6575" class="Symbol">(Œª</a> <a id="6578" href="Cost.html#6578" class="Bound">x</a> <a id="6580" class="Symbol">‚Üí</a> <a id="6582" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="6586" class="Symbol">)</a> <a id="6588" href="Cost.html#775" class="InductiveConstructor Operator">,,</a> <a id="6591" href="Cost.html#6213" class="Postulate">Tallying-budget-identity ≥</a> <a id="6617" class="Symbol">}</a>

<a id="tallyingCekMachineCost"></a><a id="6620" href="Cost.html#6620" class="Function">tallyingCekMachineCost</a> <a id="6643" class="Symbol">:</a> <a id="6645" href="Cost.html#3578" class="Function">CostModel</a> <a id="6655" class="Symbol">‚Üí</a> <a id="6657" href="Cost.Base.html#1613" class="Datatype">ExBudgetCategory</a> <a id="6674" class="Symbol">‚Üí</a> <a id="6676" href="Cost.html#5540" class="Function">TallyingBudget</a>
<a id="6691" href="Cost.html#6620" class="Function">tallyingCekMachineCost</a> <a id="6714" href="Cost.html#6714" class="Bound">cm</a> <a id="6717" href="Cost.html#6717" class="Bound">k</a> <a id="6719" class="Symbol">=</a> 
      <a id="6728" class="Keyword">let</a> <a id="6732" href="Cost.html#6732" class="Bound">spent</a> <a id="6738" class="Symbol">=</a> <a id="6740" href="Cost.html#4319" class="Function">exBudgetCategoryCost</a> <a id="6761" href="Cost.html#6714" class="Bound">cm</a> <a id="6764" href="Cost.html#6717" class="Bound">k</a> 
      <a id="6773" class="Keyword">in</a> <a id="6776" href="Data.Tree.AVL.Map.html#1320" class="Function">singleton</a> <a id="6786" class="Symbol">(</a><a id="6787" href="Cost.html#5317" class="Function">mkKeyFromExBudgetCategory</a> <a id="6813" href="Cost.html#6717" class="Bound">k</a><a id="6814" class="Symbol">)</a> <a id="6816" href="Cost.html#6732" class="Bound">spent</a> <a id="6822" href="Utils.html#4752" class="InductiveConstructor Operator">,</a> <a id="6824" href="Cost.html#6732" class="Bound">spent</a>

<a id="tallyingMachineParameters"></a><a id="6831" href="Cost.html#6831" class="Function">tallyingMachineParameters</a> <a id="6857" class="Symbol">:</a> <a id="6859" href="Cost.html#3578" class="Function">CostModel</a> <a id="6869" class="Symbol">‚Üí</a> <a id="6871" href="Cost.Base.html#2033" class="Record">MachineParameters</a> <a id="6889" href="Cost.html#5540" class="Function">TallyingBudget</a>
<a id="6904" href="Cost.html#6831" class="Function">tallyingMachineParameters</a> <a id="6930" href="Cost.html#6930" class="Bound">cm</a> <a id="6933" class="Symbol">=</a> <a id="6935" class="Keyword">record</a> <a id="6942" class="Symbol">{</a> 
        <a id="6953" href="Cost.Base.html#2092" class="Field">cekMachineCost</a> <a id="6968" class="Symbol">=</a> <a id="6970" href="Cost.html#6620" class="Function">tallyingCekMachineCost</a> <a id="6993" href="Cost.html#6930" class="Bound">cm</a>
      <a id="7002" class="Symbol">;</a> <a id="7004" href="Cost.Base.html#2139" class="Field">Œµ</a> <a id="7006" class="Symbol">=</a> <a id="7008" href="Cost.html#5831" class="Function">ŒµT</a>
      <a id="7017" class="Symbol">;</a> <a id="7019" href="Cost.Base.html#2154" class="Field Operator">_‚àô_</a> <a id="7023" class="Symbol">=</a> <a id="7025" href="Cost.html#5894" class="Function Operator">_‚àôT_</a>
      <a id="7036" class="Symbol">;</a> <a id="7038" href="Cost.Base.html#2185" class="Field">costMonoid</a> <a id="7049" class="Symbol">=</a> <a id="7051" href="Cost.html#6276" class="Function">isMonoidTallyingBudget</a>
      <a id="7080" class="Symbol">}</a> 

<a id="tallyingReport"></a><a id="7084" href="Cost.html#7084" class="Function">tallyingReport</a> <a id="7099" class="Symbol">:</a> <a id="7101" href="Cost.html#5540" class="Function">TallyingBudget</a> <a id="7116" class="Symbol">‚Üí</a> <a id="7118" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="7125" href="Cost.html#7084" class="Function">tallyingReport</a> <a id="7140" class="Symbol">(</a><a id="7141" href="Cost.html#7141" class="Bound">mp</a> <a id="7144" href="Utils.html#4752" class="InductiveConstructor Operator">,</a> <a id="7146" href="Cost.html#7146" class="Bound">budget</a><a id="7152" class="Symbol">)</a> <a id="7154" class="Symbol">=</a>  
       <a id="7165" href="Cost.html#4834" class="Function">countingReport</a> <a id="7180" href="Cost.html#7146" class="Bound">budget</a>
    <a id="7191" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7194" class="String">&quot;\n&quot;</a>
    <a id="7203" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7206" class="String">&quot;\n&quot;</a>
    <a id="7215" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7218" href="Cost.html#8700" class="Function">printStepReport</a> <a id="7234" href="Cost.html#7141" class="Bound">mp</a>
    <a id="7241" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7244" class="String">&quot;\n&quot;</a>
    <a id="7253" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7256" class="String">&quot;startup    &quot;</a> <a id="7270" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7273" href="Cost.html#8313" class="Function">budgetToString</a> <a id="7288" class="Symbol">(</a><a id="7289" href="Cost.html#5604" class="Function">lookup</a> <a id="7296" href="Cost.html#7141" class="Bound">mp</a> <a id="7299" href="Cost.Base.html#1892" class="InductiveConstructor">BStartup</a><a id="7307" class="Symbol">)</a> <a id="7309" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7312" class="String">&quot;\n&quot;</a>
    <a id="7321" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7324" class="String">&quot;compute    &quot;</a> <a id="7338" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7341" href="Cost.html#8313" class="Function">budgetToString</a> <a id="7356" href="Cost.html#7974" class="Function">totalComputeCost</a> <a id="7373" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7376" class="String">&quot;\n&quot;</a>
    <a id="7385" class="Comment">-- ++ &quot;AST nodes  &quot; ++ ++ &quot;\n&quot;</a>
    <a id="7420" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7423" class="String">&quot;\n\n&quot;</a>
    <a id="7434" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7437" href="Cost.html#9146" class="Function">printBuiltinReport</a> <a id="7456" href="Cost.html#7141" class="Bound">mp</a> 
    <a id="7464" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7467" class="String">&quot;\n&quot;</a> 
    <a id="7477" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7480" class="String">&quot;Total builtin costs:   &quot;</a> <a id="7506" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7509" href="Cost.html#8313" class="Function">budgetToString</a> <a id="7524" href="Cost.html#7991" class="Function">totalBuiltinCosts</a> <a id="7542" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7545" class="String">&quot;\n&quot;</a>
     <a id="7555" class="Comment">-- We would like to be able to print the following  number as &quot;%4.2f&quot; </a>
     <a id="7631" class="Comment">-- but Agda&#39;s printf currently doesn&#39;t support it.</a>
    <a id="7686" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7689" href="Text.Printf.html#1331" class="Function">printf</a> <a id="7696" class="String">&quot;Time spent executing builtins:  %f%%\n&quot;</a> <a id="7737" class="Symbol">(</a><a id="7738" href="Agda.Builtin.Float.html#822" class="Primitive">from‚Ñï</a> <a id="7744" class="Number">100</a> <a id="7748" href="Cost.html#583" class="Primitive Operator">*f</a> <a id="7751" class="Symbol">(</a><a id="7752" href="Cost.html#8248" class="Function">getCPU</a> <a id="7759" href="Cost.html#7991" class="Function">totalBuiltinCosts</a><a id="7776" class="Symbol">)</a> <a id="7778" href="Agda.Builtin.Float.html#1500" class="Primitive Operator">√∑</a> <a id="7780" class="Symbol">(</a><a id="7781" href="Cost.html#8248" class="Function">getCPU</a> <a id="7788" href="Cost.html#7146" class="Bound">budget</a><a id="7794" class="Symbol">))</a> <a id="7797" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7800" class="String">&quot;\n&quot;</a>
    <a id="7809" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7812" class="String">&quot;\n&quot;</a>
    <a id="7821" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7824" class="String">&quot;Total budget spent:    &quot;</a> <a id="7850" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7853" href="Cost.html#8313" class="Function">budgetToString</a> <a id="7868" href="Cost.html#7146" class="Bound">budget</a> <a id="7875" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7878" class="String">&quot;\n&quot;</a>
    <a id="7887" href="Data.String.Base.html#2375" class="Function Operator">++</a>  <a id="7891" class="String">&quot;Predicted execution time: &quot;</a> <a id="7920" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7923" href="Cost.html#9396" class="Function">formatTimePicoseconds</a> <a id="7945" class="Symbol">(</a><a id="7946" href="Cost.html#8248" class="Function">getCPU</a> <a id="7953" href="Cost.html#7146" class="Bound">budget</a><a id="7959" class="Symbol">)</a>
  <a id="7963" class="Keyword">where</a> 
    <a id="7974" href="Cost.html#7974" class="Function">totalComputeCost</a> <a id="7991" href="Cost.html#7991" class="Function">totalBuiltinCosts</a> <a id="8009" class="Symbol">:</a> <a id="8011" href="Cost.html#1926" class="Record">ExBudget</a> 
    <a id="8025" href="Cost.html#7974" class="Function">totalComputeCost</a> <a id="8042" class="Symbol">=</a> <a id="8044" href="Data.List.Base.html#4201" class="Function">L.foldr</a> <a id="8052" class="Symbol">(Œª</a> <a id="8055" href="Cost.html#8055" class="Bound">x</a> <a id="8057" href="Cost.html#8057" class="Bound">acc</a> <a id="8061" class="Symbol">‚Üí</a> <a id="8063" class="Symbol">(</a><a id="8064" href="Cost.html#5604" class="Function">lookup</a> <a id="8071" href="Cost.html#7141" class="Bound">mp</a> <a id="8074" class="Symbol">(</a><a id="8075" href="Cost.Base.html#1689" class="InductiveConstructor">BStep</a> <a id="8081" href="Cost.html#8055" class="Bound">x</a><a id="8082" class="Symbol">))</a> <a id="8085" href="Cost.html#2360" class="Function Operator">‚àô‚Ç¨</a> <a id="8088" href="Cost.html#8057" class="Bound">acc</a><a id="8091" class="Symbol">)</a> <a id="8093" href="Cost.html#2303" class="Function">Œµ‚Ç¨</a> <a id="8096" href="Cost.Base.html#1370" class="Function">stepKindList</a>
    <a id="8113" href="Cost.html#7991" class="Function">totalBuiltinCosts</a> <a id="8131" class="Symbol">=</a> <a id="8133" href="Data.List.Base.html#4201" class="Function">L.foldr</a> <a id="8141" href="Cost.html#2360" class="Function Operator">_‚àô‚Ç¨_</a> <a id="8146" href="Cost.html#2303" class="Function">Œµ‚Ç¨</a> <a id="8149" class="Symbol">(</a><a id="8150" href="Data.List.Base.html#1553" class="Function">L.map</a> <a id="8156" class="Symbol">(</a><a id="8157" href="Cost.html#5604" class="Function">lookup</a> <a id="8164" href="Cost.html#7141" class="Bound">mp</a> <a id="8167" href="Function.Base.html#1040" class="Function Operator">‚àò</a> <a id="8169" class="Symbol">(Œª</a> <a id="8172" href="Cost.html#8172" class="Bound">b</a> <a id="8174" class="Symbol">‚Üí</a> <a id="8176" href="Cost.Base.html#1796" class="InductiveConstructor">BBuiltinApp</a> <a id="8188" href="Cost.html#8172" class="Bound">b</a> <a id="8190" class="Symbol">(</a><a id="8191" href="Data.Vec.Base.html#5793" class="Function">replicate</a> <a id="8201" class="Symbol">(</a><a id="8202" href="Untyped.CEK.html#1493" class="InductiveConstructor">V-con</a> <a id="8208" class="Symbol">(</a><a id="8209" href="Builtin.Signature.html#1953" class="InductiveConstructor">atomic</a> <a id="8216" href="Builtin.Constant.AtomicType.html#656" class="InductiveConstructor">aUnit</a><a id="8221" class="Symbol">)</a> <a id="8223" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="8225" class="Symbol">))))</a> <a id="8230" href="Builtin.html#26870" class="Function">builtinList</a><a id="8241" class="Symbol">)</a>

    <a id="8248" href="Cost.html#8248" class="Function">getCPU</a> <a id="8255" class="Symbol">:</a> <a id="8257" href="Cost.html#1926" class="Record">ExBudget</a> <a id="8266" class="Symbol">‚Üí</a> <a id="8268" href="Agda.Builtin.Float.html#353" class="Postulate">Float</a>
    <a id="8278" href="Cost.html#8248" class="Function">getCPU</a> <a id="8285" href="Cost.html#8285" class="Bound">n</a> <a id="8287" class="Symbol">=</a> <a id="8289" href="Agda.Builtin.Float.html#822" class="Primitive">from‚Ñï</a> <a id="8295" class="Symbol">(</a><a id="8296" href="Cost.html#1985" class="Field">ExCPU</a> <a id="8302" href="Cost.html#8285" class="Bound">n</a><a id="8303" class="Symbol">)</a>   

    <a id="8313" href="Cost.html#8313" class="Function">budgetToString</a> <a id="8328" class="Symbol">:</a> <a id="8330" href="Cost.html#1926" class="Record">ExBudget</a> <a id="8339" class="Symbol">‚Üí</a> <a id="8341" href="Agda.Builtin.String.html#335" class="Postulate">String</a> 
    <a id="8353" href="Cost.html#8313" class="Function">budgetToString</a> <a id="8368" class="Symbol">(</a><a id="8369" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> <a id="8380" href="Cost.html#8380" class="Bound">cpu</a> <a id="8384" href="Cost.html#8384" class="Bound">mem</a><a id="8387" class="Symbol">)</a> <a id="8389" class="Symbol">=</a> <a id="8391" href="Data.String.Base.html#3567" class="Function">padLeft</a> <a id="8399" class="String">&#39; &#39;</a> <a id="8403" class="Number">15</a> <a id="8406" class="Symbol">(</a><a id="8407" href="Cost.html#454" class="Function">show‚Ñï</a> <a id="8413" href="Cost.html#8380" class="Bound">cpu</a><a id="8416" class="Symbol">)</a> <a id="8418" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="8421" class="String">&quot;  &quot;</a> 
                                       <a id="8466" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="8469" href="Data.String.Base.html#3567" class="Function">padLeft</a> <a id="8477" class="String">&#39; &#39;</a> <a id="8481" class="Number">15</a> <a id="8484" class="Symbol">(</a><a id="8485" href="Cost.html#454" class="Function">show‚Ñï</a> <a id="8491" href="Cost.html#8384" class="Bound">mem</a><a id="8494" class="Symbol">)</a>

    <a id="8501" href="Cost.html#8501" class="Function">printStepCost</a> <a id="8515" class="Symbol">:</a> <a id="8517" href="Cost.Base.html#864" class="Datatype">StepKind</a> <a id="8526" class="Symbol">‚Üí</a> <a id="8528" href="Cost.html#1926" class="Record">ExBudget</a> <a id="8537" class="Symbol">‚Üí</a> <a id="8539" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="8550" href="Cost.html#8501" class="Function">printStepCost</a> <a id="8564" href="Cost.html#8564" class="Bound">sk</a> <a id="8567" href="Cost.html#8567" class="Bound">budget</a> <a id="8574" class="Symbol">=</a> <a id="8576" href="Data.String.Base.html#3686" class="Function">padRight</a> <a id="8585" class="String">&#39; &#39;</a> <a id="8589" class="Number">10</a> <a id="8592" class="Symbol">(</a><a id="8593" href="Cost.Base.html#1234" class="Function">showStepKind</a> <a id="8606" href="Cost.html#8564" class="Bound">sk</a><a id="8608" class="Symbol">)</a> <a id="8610" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="8613" class="String">&quot; &quot;</a> 
                           <a id="8645" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="8648" href="Data.String.Base.html#3567" class="Function">padLeft</a> <a id="8656" class="String">&#39; &#39;</a> <a id="8660" class="Number">20</a> <a id="8663" class="Symbol">(</a><a id="8664" href="Cost.html#8313" class="Function">budgetToString</a> <a id="8679" href="Cost.html#8567" class="Bound">budget</a><a id="8685" class="Symbol">)</a> <a id="8687" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="8690" class="String">&quot;\n&quot;</a>

    <a id="8700" href="Cost.html#8700" class="Function">printStepReport</a> <a id="8716" class="Symbol">:</a> <a id="8718" href="Data.Tree.AVL.Map.html#1120" class="Function">Map</a> <a id="8722" href="Cost.html#1926" class="Record">ExBudget</a> <a id="8731" class="Symbol">‚Üí</a> <a id="8733" href="Agda.Builtin.String.html#335" class="Postulate">String</a> 
    <a id="8745" href="Cost.html#8700" class="Function">printStepReport</a> <a id="8761" href="Cost.html#8761" class="Bound">mp</a> <a id="8764" class="Symbol">=</a> <a id="8766" href="Data.List.Base.html#4201" class="Function">L.foldr</a> <a id="8774" class="Symbol">(Œª</a> <a id="8777" href="Cost.html#8777" class="Bound">s</a> <a id="8779" href="Cost.html#8779" class="Bound">xs</a> <a id="8782" class="Symbol">‚Üí</a> <a id="8784" href="Cost.html#8501" class="Function">printStepCost</a> <a id="8798" href="Cost.html#8777" class="Bound">s</a> <a id="8800" class="Symbol">(</a><a id="8801" href="Cost.html#5604" class="Function">lookup</a> <a id="8808" href="Cost.html#8761" class="Bound">mp</a> <a id="8811" class="Symbol">(</a><a id="8812" href="Cost.Base.html#1689" class="InductiveConstructor">BStep</a> <a id="8818" href="Cost.html#8777" class="Bound">s</a><a id="8819" class="Symbol">))</a> <a id="8822" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="8825" href="Cost.html#8779" class="Bound">xs</a><a id="8827" class="Symbol">)</a>
                               <a id="8860" class="String">&quot;&quot;</a> 
                               <a id="8895" href="Cost.Base.html#1370" class="Function">stepKindList</a>

    <a id="8913" href="Cost.html#8913" class="Function">printBuiltinCost</a> <a id="8930" class="Symbol">:</a> <a id="8932" href="Builtin.html#1212" class="Datatype">Builtin</a> <a id="8940" class="Symbol">‚Üí</a> <a id="8942" href="Cost.html#1926" class="Record">ExBudget</a> <a id="8951" class="Symbol">‚Üí</a> <a id="8953" href="Agda.Builtin.String.html#335" class="Postulate">String</a> 
    <a id="8965" href="Cost.html#8913" class="Function">printBuiltinCost</a> <a id="8982" href="Cost.html#8982" class="Bound">b</a> <a id="8984" class="Symbol">(</a><a id="8985" href="Cost.html#1961" class="InductiveConstructor">mkExBudget</a> <a id="8996" class="Number">0</a> <a id="8998" class="Number">0</a><a id="8999" class="Symbol">)</a> <a id="9001" class="Symbol">=</a> <a id="9003" class="String">&quot;&quot;</a> 
    <a id="9011" href="Cost.html#8913" class="CatchallClause Function">printBuiltinCost</a><a id="9027" class="CatchallClause"> </a><a id="9028" href="Cost.html#9028" class="CatchallClause Bound">b</a><a id="9029" class="CatchallClause"> </a><a id="9030" href="Cost.html#9030" class="CatchallClause Bound">budget</a> <a id="9037" class="Symbol">=</a> <a id="9039" href="Data.String.Base.html#3686" class="Function">padRight</a> <a id="9048" class="String">&#39; &#39;</a> <a id="9052" class="Number">22</a> <a id="9055" class="Symbol">(</a><a id="9056" href="Builtin.html#26722" class="Function">showBuiltin</a> <a id="9068" href="Cost.html#9028" class="Bound">b</a><a id="9069" class="Symbol">)</a> <a id="9071" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="9074" class="String">&quot; &quot;</a> 
                             <a id="9108" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="9111" href="Cost.html#8313" class="Function">budgetToString</a> <a id="9126" href="Cost.html#9030" class="Bound">budget</a> <a id="9133" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="9136" class="String">&quot;\n&quot;</a>

    <a id="9146" href="Cost.html#9146" class="Function">printBuiltinReport</a> <a id="9165" class="Symbol">:</a> <a id="9167" href="Data.Tree.AVL.Map.html#1120" class="Function">Map</a> <a id="9171" href="Cost.html#1926" class="Record">ExBudget</a> <a id="9180" class="Symbol">‚Üí</a> <a id="9182" href="Agda.Builtin.String.html#335" class="Postulate">String</a> 
    <a id="9194" href="Cost.html#9146" class="Function">printBuiltinReport</a> <a id="9213" href="Cost.html#9213" class="Bound">mp</a> <a id="9216" class="Symbol">=</a> 
        <a id="9227" href="Data.List.Base.html#4201" class="Function">L.foldr</a> <a id="9235" class="Symbol">(Œª</a> <a id="9238" href="Cost.html#9238" class="Bound">b</a> <a id="9240" href="Cost.html#9240" class="Bound">xs</a> <a id="9243" class="Symbol">‚Üí</a> <a id="9245" href="Cost.html#8913" class="Function">printBuiltinCost</a> <a id="9262" href="Cost.html#9238" class="Bound">b</a> <a id="9264" class="Symbol">(</a><a id="9265" href="Cost.html#5604" class="Function">lookup</a> <a id="9272" href="Cost.html#9213" class="Bound">mp</a> <a id="9275" class="Symbol">(</a><a id="9276" href="Cost.Base.html#1796" class="InductiveConstructor">BBuiltinApp</a> <a id="9288" href="Cost.html#9238" class="Bound">b</a> <a id="9290" class="Symbol">(</a><a id="9291" href="Data.Vec.Base.html#5793" class="Function">replicate</a> <a id="9301" class="Symbol">(</a><a id="9302" href="Untyped.CEK.html#1493" class="InductiveConstructor">V-con</a> <a id="9308" class="Symbol">(</a><a id="9309" href="Builtin.Signature.html#1953" class="InductiveConstructor">atomic</a> <a id="9316" href="Builtin.Constant.AtomicType.html#656" class="InductiveConstructor">aUnit</a><a id="9321" class="Symbol">)</a> <a id="9323" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="9325" class="Symbol">))))</a> <a id="9330" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="9333" href="Cost.html#9240" class="Bound">xs</a><a id="9335" class="Symbol">)</a> 
              <a id="9352" class="String">&quot;&quot;</a> 
              <a id="9370" href="Builtin.html#26870" class="Function">builtinList</a>     
    
    <a id="9396" href="Cost.html#9396" class="Function">formatTimePicoseconds</a> <a id="9418" class="Symbol">:</a> <a id="9420" href="Agda.Builtin.Float.html#353" class="Postulate">Float</a> <a id="9426" class="Symbol">‚Üí</a> <a id="9428" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="9439" href="Cost.html#9396" class="Function">formatTimePicoseconds</a> <a id="9461" href="Cost.html#9461" class="Bound">t</a> <a id="9463" class="Symbol">=</a> <a id="9465" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="9468" class="Number">1e12</a> <a id="9473" href="Agda.Builtin.Float.html#421" class="Primitive Operator">‚â§·µá</a> <a id="9476" href="Cost.html#9461" class="Bound">t</a> <a id="9478" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="9483" class="Symbol">(</a><a id="9484" href="Text.Printf.html#1331" class="Function">printf</a> <a id="9491" class="String">&quot;%f s&quot;</a> <a id="9498" class="Symbol">(</a><a id="9499" href="Cost.html#9461" class="Bound">t</a> <a id="9501" href="Agda.Builtin.Float.html#1500" class="Primitive Operator">√∑</a> <a id="9503" class="Number">1e12</a><a id="9507" class="Symbol">))</a> <a id="9510" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
                              <a id="9545" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="9548" class="Number">1e9</a> <a id="9552" href="Agda.Builtin.Float.html#421" class="Primitive Operator">‚â§·µá</a> <a id="9555" href="Cost.html#9461" class="Bound">t</a> <a id="9557" href="Data.Bool.Base.html#1292" class="Function Operator">then</a>  <a id="9563" class="Symbol">(</a><a id="9564" href="Text.Printf.html#1331" class="Function">printf</a> <a id="9571" class="String">&quot;%f ms&quot;</a> <a id="9579" class="Symbol">(</a><a id="9580" href="Cost.html#9461" class="Bound">t</a> <a id="9582" href="Agda.Builtin.Float.html#1500" class="Primitive Operator">√∑</a> <a id="9584" class="Number">1e9</a><a id="9587" class="Symbol">))</a> <a id="9590" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
                              <a id="9625" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="9628" class="Number">1e6</a> <a id="9632" href="Agda.Builtin.Float.html#421" class="Primitive Operator">‚â§·µá</a> <a id="9635" href="Cost.html#9461" class="Bound">t</a> <a id="9637" href="Data.Bool.Base.html#1292" class="Function Operator">then</a>  <a id="9643" class="Symbol">(</a><a id="9644" href="Text.Printf.html#1331" class="Function">printf</a> <a id="9651" class="String">&quot;%f Œºs&quot;</a> <a id="9659" class="Symbol">(</a><a id="9660" href="Cost.html#9461" class="Bound">t</a> <a id="9662" href="Agda.Builtin.Float.html#1500" class="Primitive Operator">√∑</a> <a id="9664" class="Number">1e6</a><a id="9667" class="Symbol">))</a> <a id="9670" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
                              <a id="9705" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="9708" class="Number">1e3</a> <a id="9712" href="Agda.Builtin.Float.html#421" class="Primitive Operator">‚â§·µá</a> <a id="9715" href="Cost.html#9461" class="Bound">t</a> <a id="9717" href="Data.Bool.Base.html#1292" class="Function Operator">then</a>  <a id="9723" class="Symbol">(</a><a id="9724" href="Text.Printf.html#1331" class="Function">printf</a> <a id="9731" class="String">&quot;%f ns&quot;</a> <a id="9739" class="Symbol">(</a><a id="9740" href="Cost.html#9461" class="Bound">t</a> <a id="9742" href="Agda.Builtin.Float.html#1500" class="Primitive Operator">√∑</a> <a id="9744" class="Number">1e3</a><a id="9747" class="Symbol">))</a> <a id="9750" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
                              <a id="9785" href="Text.Printf.html#1331" class="Function">printf</a> <a id="9792" class="String">&quot;%f ps&quot;</a> <a id="9800" href="Cost.html#9461" class="Bound">t</a>
</pre>