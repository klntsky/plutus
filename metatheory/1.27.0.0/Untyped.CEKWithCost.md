# CEK Machine with costs

This module implements a CEK machine for UPLC which computes costs.

<pre class="Agda"><a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Cost.Base.html" class="Module">Cost.Base</a>

<a id="123" class="Keyword">module</a> <a id="130" href="Untyped.CEKWithCost.html" class="Module">Untyped.CEKWithCost</a> <a id="150" class="Symbol">{</a><a id="151" href="Untyped.CEKWithCost.html#151" class="Bound">Budget</a> <a id="158" class="Symbol">:</a> <a id="160" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="163" class="Symbol">}(</a><a id="165" href="Untyped.CEKWithCost.html#165" class="Bound">machineParameters</a> <a id="183" class="Symbol">:</a> <a id="185" href="Cost.Base.html#2033" class="Record">MachineParameters</a> <a id="203" href="Untyped.CEKWithCost.html#151" class="Bound">Budget</a><a id="209" class="Symbol">)</a> <a id="211" class="Keyword">where</a>
</pre>
## Imports

<pre class="Agda"><a id="238" class="Keyword">open</a> <a id="243" class="Keyword">import</a> <a id="250" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="260" class="Keyword">using</a> <a id="266" class="Symbol">(</a><a id="267" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a><a id="268" class="Symbol">;</a><a id="269" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="271" class="Symbol">)</a>
<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="294" class="Keyword">using</a> <a id="300" class="Symbol">(</a><a id="301" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="302" class="Symbol">;</a><a id="303" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="307" class="Symbol">;</a><a id="308" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a><a id="311" class="Symbol">)</a>
<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Data.List.html" class="Module">Data.List</a> <a id="335" class="Keyword">using</a> <a id="341" class="Symbol">(</a><a id="342" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="346" class="Symbol">;</a><a id="347" href="Data.List.Base.html#10392" class="InductiveConstructor">[]</a><a id="349" class="Symbol">;</a><a id="350" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="353" class="Symbol">)</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="376" class="Keyword">using</a> <a id="382" class="Symbol">(</a><a id="383" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a><a id="386" class="Symbol">;</a><a id="387" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a><a id="389" class="Symbol">;</a><a id="390" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">_∷_</a><a id="393" class="Symbol">;</a><a id="394" href="Data.Vec.Base.html#7783" class="Function">reverse</a><a id="401" class="Symbol">)</a>
<a id="403" class="Keyword">open</a> <a id="408" class="Keyword">import</a> <a id="415" href="Data.Product.html" class="Module">Data.Product</a> <a id="428" class="Keyword">using</a> <a id="434" class="Symbol">(</a><a id="435" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="438" class="Symbol">)</a>
<a id="440" class="Keyword">open</a> <a id="445" class="Keyword">import</a> <a id="452" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="490" class="Keyword">using</a> <a id="496" class="Symbol">(</a><a id="497" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="500" class="Symbol">;</a><a id="501" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="505" class="Symbol">;</a><a id="506" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a><a id="509" class="Symbol">)</a>

<a id="512" class="Keyword">open</a> <a id="517" class="Keyword">import</a> <a id="524" href="Untyped.html" class="Module">Untyped</a> <a id="532" class="Keyword">using</a> <a id="538" class="Symbol">(</a><a id="539" href="Untyped.html#1295" class="Datatype Operator">_⊢</a><a id="541" class="Symbol">)</a>
<a id="543" class="Keyword">open</a> <a id="548" href="Untyped.html#1295" class="Module Operator">_⊢</a>
<a id="551" class="Keyword">open</a> <a id="556" class="Keyword">import</a> <a id="563" href="Utils.html" class="Module">Utils</a> <a id="569" class="Keyword">using</a> <a id="575" class="Symbol">(</a><a id="576" href="Utils.html#3918" class="Record">Writer</a><a id="582" class="Symbol">;</a><a id="583" href="Utils.html#2951" class="Function Operator">_&gt;&gt;_</a><a id="587" class="Symbol">;</a><a id="588" href="Utils.html#2907" class="Field Operator">_&gt;&gt;=_</a><a id="593" class="Symbol">;</a><a id="594" href="Utils.html#2879" class="Field">return</a><a id="600" class="Symbol">;</a><a id="601" href="Data.Maybe.Base.html#1371" class="Function">maybe</a><a id="606" class="Symbol">;</a><a id="607" href="Utils.html#1092" class="Datatype">Either</a><a id="613" class="Symbol">;</a><a id="614" href="Utils.html#1125" class="InductiveConstructor">inj₁</a><a id="618" class="Symbol">;</a><a id="619" href="Utils.html#1149" class="InductiveConstructor">inj₂</a><a id="623" class="Symbol">;</a><a id="624" href="Utils.html#4328" class="Datatype">RuntimeError</a><a id="636" class="Symbol">;</a><a id="637" href="Utils.html#4355" class="InductiveConstructor">gasError</a><a id="645" class="Symbol">;</a><a id="646" href="Utils.html#1229" class="Function">either</a><a id="652" class="Symbol">;</a><a id="653" href="Utils.html#2157" class="Datatype Operator">_∔_≣_</a><a id="658" class="Symbol">)</a>
<a id="660" class="Keyword">open</a> <a id="665" href="Utils.html#3918" class="Module">Writer</a>
<a id="672" class="Keyword">open</a> <a id="677" class="Keyword">import</a> <a id="684" href="RawU.html" class="Module">RawU</a> <a id="689" class="Keyword">using</a> <a id="695" class="Symbol">(</a><a id="696" href="RawU.html#7605" class="InductiveConstructor">tmCon</a><a id="701" class="Symbol">)</a>
<a id="703" class="Keyword">open</a> <a id="708" class="Keyword">import</a> <a id="715" href="Builtin.html" class="Module">Builtin</a> <a id="723" class="Keyword">using</a> <a id="729" class="Symbol">(</a><a id="730" href="Builtin.html#1212" class="Datatype">Builtin</a><a id="737" class="Symbol">;</a><a id="738" href="Builtin.html#14096" class="Function">arity</a><a id="743" class="Symbol">;</a><a id="744" href="Builtin.html#7315" class="Function">signature</a><a id="753" class="Symbol">)</a>
<a id="755" class="Keyword">open</a> <a id="760" class="Keyword">import</a> <a id="767" href="Builtin.Signature.html" class="Module">Builtin.Signature</a> <a id="785" class="Keyword">using</a> <a id="791" class="Symbol">(</a><a id="792" href="Builtin.Signature.html#3990" class="Function">fv</a><a id="794" class="Symbol">;</a><a id="795" href="Builtin.Signature.html#3888" class="Function">args♯</a><a id="800" class="Symbol">)</a>

<a id="803" class="Keyword">open</a> <a id="808" href="Cost.Base.html#864" class="Module">StepKind</a>
<a id="817" class="Keyword">open</a> <a id="822" href="Cost.Base.html#1613" class="Module">ExBudgetCategory</a>

<a id="840" class="Keyword">open</a> <a id="845" class="Keyword">import</a> <a id="852" href="Untyped.CEK.html" class="Module">Untyped.CEK</a>

</pre>
## Cost Monad

We instantiate a Writer Monad with the operations from the machine parameters


<pre class="Agda"><a id="969" class="Keyword">open</a> <a id="974" href="Cost.Base.html#2033" class="Module">MachineParameters</a> <a id="992" href="Untyped.CEKWithCost.html#165" class="Bound">machineParameters</a> <a id="1010" class="Keyword">renaming</a> <a id="1019" class="Symbol">(</a><a id="1020" href="Cost.Base.html#2139" class="Field">ε</a> <a id="1022" class="Symbol">to</a> <a id="1025" class="Field">e</a><a id="1026" class="Symbol">)</a>
<a id="1028" class="Keyword">open</a> <a id="1033" href="Utils.html#4025" class="Module">Utils.WriterMonad</a> <a id="1051" href="Untyped.CEKWithCost.html#1025" class="Field">e</a> <a id="1053" href="Cost.Base.html#2154" class="Field Operator">_∙_</a>

<a id="CekM"></a><a id="1058" href="Untyped.CEKWithCost.html#1058" class="Function">CekM</a> <a id="1063" class="Symbol">:</a> <a id="1065" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1069" class="Symbol">→</a> <a id="1071" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1075" href="Untyped.CEKWithCost.html#1058" class="Function">CekM</a> <a id="1080" class="Symbol">=</a> <a id="1082" href="Utils.html#3918" class="Record">Writer</a> <a id="1089" href="Untyped.CEKWithCost.html#151" class="Bound">Budget</a>
</pre>
### Spending operations

As opposed to the production implemention, our `spend` function does not implement slippage.
Slippage is an optimization that allows the interpreter to only add costs every n steps. 
Slippage is only semantically relevant in restricting mode (not currently implemented in agda), 
so we do not need to consider it here.

<pre class="Agda"><a id="spend"></a><a id="1450" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="1456" class="Symbol">:</a> <a id="1458" href="Cost.Base.html#864" class="Datatype">StepKind</a> <a id="1467" class="Symbol">→</a> <a id="1469" href="Untyped.CEKWithCost.html#1058" class="Function">CekM</a> <a id="1474" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1476" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="1482" href="Untyped.CEKWithCost.html#1482" class="Bound">st</a> <a id="1485" class="Symbol">=</a> <a id="1487" href="Utils.html#4241" class="Function">tell</a> <a id="1492" class="Symbol">(</a><a id="1493" href="Cost.Base.html#2092" class="Field">cekMachineCost</a> <a id="1508" class="Symbol">(</a><a id="1509" href="Cost.Base.html#1689" class="InductiveConstructor">BStep</a> <a id="1515" href="Untyped.CEKWithCost.html#1482" class="Bound">st</a><a id="1517" class="Symbol">))</a>

<a id="spendStartupCost"></a><a id="1521" href="Untyped.CEKWithCost.html#1521" class="Function">spendStartupCost</a> <a id="1538" class="Symbol">:</a> <a id="1540" href="Untyped.CEKWithCost.html#1058" class="Function">CekM</a> <a id="1545" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1547" href="Untyped.CEKWithCost.html#1521" class="Function">spendStartupCost</a> <a id="1564" class="Symbol">=</a> <a id="1566" href="Utils.html#4241" class="Function">tell</a> <a id="1571" href="Cost.Base.html#2222" class="Function">startupCost</a>
</pre>
In order to calculate the cost of executing a builtin, we obtain a vector with 
the size of each constant argument using `extractArgSizes`. 

Non-constant argument should only occur in places where the builtin is polymorphic
and should be ignored by the cost model of the corresponding builtin. Therefore, 
they are added with a size of 0.

The function `extractArgSizes` get the arguments in inverse order, so we reverse 
them in the `spendBuiltin` function. 

<pre class="Agda"><a id="extractConstants"></a><a id="2054" href="Untyped.CEKWithCost.html#2054" class="Function">extractConstants</a> <a id="2071" class="Symbol">:</a> <a id="2073" class="Symbol">∀{</a><a id="2075" href="Untyped.CEKWithCost.html#2075" class="Bound">b</a><a id="2076" class="Symbol">}</a>
          <a id="2088" class="Symbol">→</a> <a id="2090" class="Symbol">∀{</a><a id="2092" href="Untyped.CEKWithCost.html#2092" class="Bound">tn</a> <a id="2095" href="Untyped.CEKWithCost.html#2095" class="Bound">tm</a><a id="2097" class="Symbol">}</a> <a id="2099" class="Symbol">→</a> <a id="2101" class="Symbol">{</a><a id="2102" href="Untyped.CEKWithCost.html#2102" class="Bound">pt</a> <a id="2105" class="Symbol">:</a> <a id="2107" href="Untyped.CEKWithCost.html#2092" class="Bound">tn</a> <a id="2110" href="Utils.html#2157" class="Datatype Operator">∔</a> <a id="2112" href="Untyped.CEKWithCost.html#2095" class="Bound">tm</a> <a id="2115" href="Utils.html#2157" class="Datatype Operator">≣</a> <a id="2117" href="Builtin.Signature.html#3990" class="Function">fv</a> <a id="2120" class="Symbol">(</a><a id="2121" href="Builtin.html#7315" class="Function">signature</a> <a id="2131" href="Untyped.CEKWithCost.html#2075" class="Bound">b</a><a id="2132" class="Symbol">)}</a>
          <a id="2145" class="Symbol">→</a> <a id="2147" class="Symbol">∀{</a><a id="2149" href="Untyped.CEKWithCost.html#2149" class="Bound">an</a> <a id="2152" href="Untyped.CEKWithCost.html#2152" class="Bound">am</a><a id="2154" class="Symbol">}</a> <a id="2156" class="Symbol">→</a> <a id="2158" class="Symbol">{</a><a id="2159" href="Untyped.CEKWithCost.html#2159" class="Bound">pa</a> <a id="2162" class="Symbol">:</a> <a id="2164" href="Untyped.CEKWithCost.html#2149" class="Bound">an</a> <a id="2167" href="Utils.html#2157" class="Datatype Operator">∔</a> <a id="2169" href="Untyped.CEKWithCost.html#2152" class="Bound">am</a> <a id="2172" href="Utils.html#2157" class="Datatype Operator">≣</a> <a id="2174" href="Builtin.Signature.html#3888" class="Function">args♯</a> <a id="2180" class="Symbol">(</a><a id="2181" href="Builtin.html#7315" class="Function">signature</a> <a id="2191" href="Untyped.CEKWithCost.html#2075" class="Bound">b</a><a id="2192" class="Symbol">)}</a>
          <a id="2205" class="Symbol">→</a> <a id="2207" href="Untyped.CEK.html#1327" class="Datatype">BApp</a> <a id="2212" href="Untyped.CEKWithCost.html#2075" class="Bound">b</a> <a id="2214" href="Untyped.CEKWithCost.html#2102" class="Bound">pt</a> <a id="2217" href="Untyped.CEKWithCost.html#2159" class="Bound">pa</a> <a id="2220" class="Symbol">→</a> <a id="2222" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="2226" href="Untyped.CEK.html#1224" class="Datatype">Value</a> <a id="2232" href="Untyped.CEKWithCost.html#2149" class="Bound">an</a>
<a id="2235" href="Untyped.CEKWithCost.html#2054" class="Function">extractConstants</a> <a id="2252" href="Untyped.CEK.html#1970" class="InductiveConstructor">base</a> <a id="2257" class="Symbol">=</a> <a id="2259" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a>
<a id="2262" href="Untyped.CEKWithCost.html#2054" class="Function">extractConstants</a> <a id="2279" class="Symbol">(</a><a id="2280" href="Untyped.CEK.html#2043" class="InductiveConstructor">app</a> <a id="2284" href="Untyped.CEKWithCost.html#2284" class="Bound">bapp</a> <a id="2289" href="Untyped.CEKWithCost.html#2289" class="Bound">v</a><a id="2290" class="Symbol">)</a> <a id="2292" class="Symbol">=</a> <a id="2294" href="Untyped.CEKWithCost.html#2289" class="Bound">v</a> <a id="2296" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">∷</a> <a id="2298" href="Untyped.CEKWithCost.html#2054" class="Function">extractConstants</a> <a id="2315" href="Untyped.CEKWithCost.html#2284" class="Bound">bapp</a>
<a id="2320" href="Untyped.CEKWithCost.html#2054" class="Function">extractConstants</a> <a id="2337" class="Symbol">(</a><a id="2338" href="Untyped.CEK.html#2211" class="InductiveConstructor">app⋆</a> <a id="2343" href="Untyped.CEKWithCost.html#2343" class="Bound">bapp</a><a id="2347" class="Symbol">)</a> <a id="2349" class="Symbol">=</a> <a id="2351" href="Untyped.CEKWithCost.html#2054" class="Function">extractConstants</a> <a id="2368" href="Untyped.CEKWithCost.html#2343" class="Bound">bapp</a> 

<a id="spendBuiltin"></a><a id="2375" href="Untyped.CEKWithCost.html#2375" class="Function">spendBuiltin</a> <a id="2388" class="Symbol">:</a> <a id="2390" class="Symbol">(</a><a id="2391" href="Untyped.CEKWithCost.html#2391" class="Bound">b</a> <a id="2393" class="Symbol">:</a> <a id="2395" href="Builtin.html#1212" class="Datatype">Builtin</a><a id="2402" class="Symbol">)</a> <a id="2404" class="Symbol">→</a> <a id="2406" href="Untyped.CEK.html#4026" class="Function">fullyAppliedBuiltin</a> <a id="2426" href="Untyped.CEKWithCost.html#2391" class="Bound">b</a> <a id="2428" class="Symbol">→</a> <a id="2430" href="Untyped.CEKWithCost.html#1058" class="Function">CekM</a> <a id="2435" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="2437" href="Untyped.CEKWithCost.html#2375" class="Function">spendBuiltin</a> <a id="2450" href="Untyped.CEKWithCost.html#2450" class="Bound">b</a> <a id="2452" href="Untyped.CEKWithCost.html#2452" class="Bound">bapp</a> <a id="2457" class="Symbol">=</a> <a id="2459" href="Utils.html#4241" class="Function">tell</a> <a id="2464" class="Symbol">(</a><a id="2465" href="Cost.Base.html#2092" class="Field">cekMachineCost</a> <a id="2480" class="Symbol">(</a><a id="2481" href="Cost.Base.html#1796" class="InductiveConstructor">BBuiltinApp</a> <a id="2493" href="Untyped.CEKWithCost.html#2450" class="Bound">b</a> <a id="2495" href="Untyped.CEKWithCost.html#2517" class="Function">argsizes</a><a id="2503" class="Symbol">))</a>
     <a id="2511" class="Keyword">where</a> <a id="2517" href="Untyped.CEKWithCost.html#2517" class="Function">argsizes</a> <a id="2526" class="Symbol">=</a> <a id="2528" href="Data.Vec.Base.html#7783" class="Function">reverse</a> <a id="2536" class="Symbol">(</a><a id="2537" href="Untyped.CEKWithCost.html#2054" class="Function">extractConstants</a> <a id="2554" href="Untyped.CEKWithCost.html#2452" class="Bound">bapp</a><a id="2558" class="Symbol">)</a>
</pre>
## Step with costs

Function `step` performs a single step in the CEK machine.

<pre class="Agda"><a id="stepC"></a><a id="2649" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="2655" class="Symbol">:</a> <a id="2657" href="Untyped.CEK.html#3507" class="Datatype">State</a> <a id="2663" class="Symbol">→</a> <a id="2665" href="Untyped.CEKWithCost.html#1058" class="Function">CekM</a> <a id="2670" href="Untyped.CEK.html#3507" class="Datatype">State</a>
<a id="2676" class="Comment">-- computeCEK in the Haskell implementation</a>
<a id="2720" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="2726" class="Symbol">(</a><a id="2727" href="Untyped.CEKWithCost.html#2727" class="Bound">s</a> <a id="2729" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="2731" href="Untyped.CEKWithCost.html#2731" class="Bound">ρ</a> <a id="2733" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="2735" href="Untyped.html#1322" class="InductiveConstructor">`</a> <a id="2737" href="Untyped.CEKWithCost.html#2737" class="Bound">x</a><a id="2738" class="Symbol">)</a>               <a id="2754" class="Symbol">=</a> <a id="2756" class="Keyword">do</a>
    <a id="2763" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="2769" href="Cost.Base.html#904" class="InductiveConstructor">BVar</a>
    <a id="2778" href="Utils.html#2879" class="Field">return</a> <a id="2785" class="Symbol">(</a><a id="2786" href="Untyped.CEKWithCost.html#2727" class="Bound">s</a> <a id="2788" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="2790" href="Untyped.CEK.html#3707" class="Function">lookup</a> <a id="2797" href="Untyped.CEKWithCost.html#2731" class="Bound">ρ</a> <a id="2799" href="Untyped.CEKWithCost.html#2737" class="Bound">x</a><a id="2800" class="Symbol">)</a>
<a id="2802" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="2808" class="Symbol">(</a><a id="2809" href="Untyped.CEKWithCost.html#2809" class="Bound">s</a> <a id="2811" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="2813" href="Untyped.CEKWithCost.html#2813" class="Bound">ρ</a> <a id="2815" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="2817" href="Untyped.html#1338" class="InductiveConstructor">ƛ</a> <a id="2819" href="Untyped.CEKWithCost.html#2819" class="Bound">t</a><a id="2820" class="Symbol">)</a>               <a id="2836" class="Symbol">=</a> <a id="2838" class="Keyword">do</a>
    <a id="2845" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="2851" href="Cost.Base.html#915" class="InductiveConstructor">BLamAbs</a>
    <a id="2863" href="Utils.html#2879" class="Field">return</a> <a id="2870" class="Symbol">(</a><a id="2871" href="Untyped.CEKWithCost.html#2809" class="Bound">s</a> <a id="2873" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="2875" href="Untyped.CEK.html#1452" class="InductiveConstructor">V-ƛ</a> <a id="2879" href="Untyped.CEKWithCost.html#2813" class="Bound">ρ</a> <a id="2881" href="Untyped.CEKWithCost.html#2819" class="Bound">t</a><a id="2882" class="Symbol">)</a>
<a id="2884" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="2890" class="Symbol">(</a><a id="2891" href="Untyped.CEKWithCost.html#2891" class="Bound">s</a> <a id="2893" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="2895" href="Untyped.CEKWithCost.html#2895" class="Bound">ρ</a> <a id="2897" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="2899" class="Symbol">(</a><a id="2900" href="Untyped.CEKWithCost.html#2900" class="Bound">t</a> <a id="2902" href="Untyped.html#1362" class="InductiveConstructor Operator">·</a> <a id="2904" href="Untyped.CEKWithCost.html#2904" class="Bound">u</a><a id="2905" class="Symbol">))</a>           <a id="2918" class="Symbol">=</a> <a id="2920" class="Keyword">do</a>
    <a id="2927" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="2933" href="Cost.Base.html#929" class="InductiveConstructor">BApply</a>
    <a id="2944" href="Utils.html#2879" class="Field">return</a> <a id="2951" class="Symbol">((</a><a id="2953" href="Untyped.CEKWithCost.html#2891" class="Bound">s</a> <a id="2955" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="2957" href="Untyped.CEK.html#3290" class="InductiveConstructor">-·</a> <a id="2960" href="Untyped.CEKWithCost.html#2895" class="Bound">ρ</a> <a id="2962" href="Untyped.CEKWithCost.html#2904" class="Bound">u</a><a id="2963" class="Symbol">)</a> <a id="2965" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="2967" href="Untyped.CEKWithCost.html#2895" class="Bound">ρ</a> <a id="2969" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="2971" href="Untyped.CEKWithCost.html#2900" class="Bound">t</a><a id="2972" class="Symbol">)</a>
<a id="2974" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="2980" class="Symbol">(</a><a id="2981" href="Untyped.CEKWithCost.html#2981" class="Bound">s</a> <a id="2983" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="2985" href="Untyped.CEKWithCost.html#2985" class="Bound">ρ</a> <a id="2987" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="2989" href="Untyped.html#1386" class="InductiveConstructor">force</a> <a id="2995" href="Untyped.CEKWithCost.html#2995" class="Bound">t</a><a id="2996" class="Symbol">)</a>           <a id="3008" class="Symbol">=</a> <a id="3010" class="Keyword">do</a>
    <a id="3017" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="3023" href="Cost.Base.html#955" class="InductiveConstructor">BForce</a>
    <a id="3034" href="Utils.html#2879" class="Field">return</a> <a id="3041" class="Symbol">((</a><a id="3043" href="Untyped.CEKWithCost.html#2981" class="Bound">s</a> <a id="3045" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="3047" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="3053" class="Symbol">)</a> <a id="3055" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3057" href="Untyped.CEKWithCost.html#2985" class="Bound">ρ</a> <a id="3059" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3061" href="Untyped.CEKWithCost.html#2995" class="Bound">t</a><a id="3062" class="Symbol">)</a>
<a id="3064" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3070" class="Symbol">(</a><a id="3071" href="Untyped.CEKWithCost.html#3071" class="Bound">s</a> <a id="3073" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3075" href="Untyped.CEKWithCost.html#3075" class="Bound">ρ</a> <a id="3077" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3079" href="Untyped.html#1406" class="InductiveConstructor">delay</a> <a id="3085" href="Untyped.CEKWithCost.html#3085" class="Bound">t</a><a id="3086" class="Symbol">)</a>           <a id="3098" class="Symbol">=</a> <a id="3100" class="Keyword">do</a> 
    <a id="3108" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="3114" href="Cost.Base.html#942" class="InductiveConstructor">BDelay</a>
    <a id="3125" href="Utils.html#2879" class="Field">return</a> <a id="3132" class="Symbol">(</a><a id="3133" href="Untyped.CEKWithCost.html#3071" class="Bound">s</a> <a id="3135" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="3137" href="Untyped.CEK.html#1536" class="InductiveConstructor">V-delay</a> <a id="3145" href="Untyped.CEKWithCost.html#3075" class="Bound">ρ</a> <a id="3147" href="Untyped.CEKWithCost.html#3085" class="Bound">t</a><a id="3148" class="Symbol">)</a>
<a id="3150" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3156" class="Symbol">(</a><a id="3157" href="Untyped.CEKWithCost.html#3157" class="Bound">s</a> <a id="3159" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3161" href="Untyped.CEKWithCost.html#3161" class="Bound">ρ</a> <a id="3163" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3165" href="Untyped.html#1426" class="InductiveConstructor">con</a> <a id="3169" class="Symbol">(</a><a id="3170" href="RawU.html#7605" class="InductiveConstructor">tmCon</a> <a id="3176" href="Untyped.CEKWithCost.html#3176" class="Bound">t</a> <a id="3178" href="Untyped.CEKWithCost.html#3178" class="Bound">c</a><a id="3179" class="Symbol">))</a>   <a id="3184" class="Symbol">=</a> <a id="3186" class="Keyword">do</a> 
    <a id="3194" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="3200" href="Cost.Base.html#890" class="InductiveConstructor">BConst</a>
    <a id="3211" href="Utils.html#2879" class="Field">return</a> <a id="3218" class="Symbol">(</a><a id="3219" href="Untyped.CEKWithCost.html#3157" class="Bound">s</a> <a id="3221" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="3223" href="Untyped.CEK.html#1493" class="InductiveConstructor">V-con</a> <a id="3229" href="Untyped.CEKWithCost.html#3176" class="Bound">t</a> <a id="3231" href="Untyped.CEKWithCost.html#3178" class="Bound">c</a><a id="3232" class="Symbol">)</a>
<a id="3234" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3240" class="Symbol">(</a><a id="3241" href="Untyped.CEKWithCost.html#3241" class="Bound">s</a> <a id="3243" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3245" href="Untyped.CEKWithCost.html#3245" class="Bound">ρ</a> <a id="3247" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3249" href="Untyped.html#1446" class="InductiveConstructor">constr</a> <a id="3256" href="Untyped.CEKWithCost.html#3256" class="Bound">i</a> <a id="3258" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3260" class="Symbol">)</a>       <a id="3268" class="Symbol">=</a> <a id="3270" class="Keyword">do</a>
    <a id="3277" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="3283" href="Cost.Base.html#1049" class="InductiveConstructor">BConstr</a>    
    <a id="3299" href="Utils.html#2879" class="Field">return</a> <a id="3306" class="Symbol">(</a><a id="3307" href="Untyped.CEKWithCost.html#3241" class="Bound">s</a> <a id="3309" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="3311" href="Untyped.CEK.html#1575" class="InductiveConstructor">V-constr</a> <a id="3320" href="Untyped.CEKWithCost.html#3256" class="Bound">i</a> <a id="3322" href="Untyped.CEK.html#1168" class="InductiveConstructor">ε</a><a id="3323" class="Symbol">)</a>
<a id="3325" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3331" class="Symbol">(</a><a id="3332" href="Untyped.CEKWithCost.html#3332" class="Bound">s</a> <a id="3334" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3336" href="Untyped.CEKWithCost.html#3336" class="Bound">ρ</a> <a id="3338" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3340" href="Untyped.html#1446" class="InductiveConstructor">constr</a> <a id="3347" href="Untyped.CEKWithCost.html#3347" class="Bound">i</a> <a id="3349" class="Symbol">(</a><a id="3350" href="Untyped.CEKWithCost.html#3350" class="Bound">x</a> <a id="3352" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3354" href="Untyped.CEKWithCost.html#3354" class="Bound">xs</a><a id="3356" class="Symbol">))</a> <a id="3359" class="Symbol">=</a> <a id="3361" class="Keyword">do</a> 
    <a id="3369" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="3375" href="Cost.Base.html#1049" class="InductiveConstructor">BConstr</a>
    <a id="3387" href="Utils.html#2879" class="Field">return</a> <a id="3394" class="Symbol">((</a><a id="3396" href="Untyped.CEKWithCost.html#3332" class="Bound">s</a> <a id="3398" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="3400" href="Untyped.CEK.html#3386" class="InductiveConstructor">constr-</a> <a id="3408" href="Untyped.CEKWithCost.html#3347" class="Bound">i</a> <a id="3410" href="Untyped.CEK.html#1168" class="InductiveConstructor">ε</a> <a id="3412" href="Untyped.CEKWithCost.html#3336" class="Bound">ρ</a> <a id="3414" href="Untyped.CEKWithCost.html#3354" class="Bound">xs</a><a id="3416" class="Symbol">)</a><a id="3417" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3419" href="Untyped.CEKWithCost.html#3336" class="Bound">ρ</a> <a id="3421" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3423" href="Untyped.CEKWithCost.html#3350" class="Bound">x</a><a id="3424" class="Symbol">)</a>
<a id="3426" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3432" class="Symbol">(</a><a id="3433" href="Untyped.CEKWithCost.html#3433" class="Bound">s</a> <a id="3435" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3437" href="Untyped.CEKWithCost.html#3437" class="Bound">ρ</a> <a id="3439" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3441" href="Untyped.html#1493" class="InductiveConstructor">case</a> <a id="3446" href="Untyped.CEKWithCost.html#3446" class="Bound">t</a> <a id="3448" href="Untyped.CEKWithCost.html#3448" class="Bound">ts</a><a id="3450" class="Symbol">)</a>         <a id="3460" class="Symbol">=</a> <a id="3462" class="Keyword">do</a> 
    <a id="3470" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="3476" href="Cost.Base.html#1064" class="InductiveConstructor">BCase</a>
    <a id="3486" href="Utils.html#2879" class="Field">return</a> <a id="3493" class="Symbol">((</a><a id="3495" href="Untyped.CEKWithCost.html#3433" class="Bound">s</a> <a id="3497" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="3499" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="3505" href="Untyped.CEKWithCost.html#3437" class="Bound">ρ</a> <a id="3507" href="Untyped.CEKWithCost.html#3448" class="Bound">ts</a><a id="3509" class="Symbol">)</a> <a id="3511" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3513" href="Untyped.CEKWithCost.html#3437" class="Bound">ρ</a> <a id="3515" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3517" href="Untyped.CEKWithCost.html#3446" class="Bound">t</a><a id="3518" class="Symbol">)</a>
<a id="3520" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3526" class="Symbol">(</a><a id="3527" href="Untyped.CEKWithCost.html#3527" class="Bound">s</a> <a id="3529" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3531" href="Untyped.CEKWithCost.html#3531" class="Bound">ρ</a> <a id="3533" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3535" href="Untyped.html#1541" class="InductiveConstructor">builtin</a> <a id="3543" href="Untyped.CEKWithCost.html#3543" class="Bound">b</a><a id="3544" class="Symbol">)</a>         <a id="3554" class="Symbol">=</a> <a id="3556" class="Keyword">do</a> 
    <a id="3564" href="Untyped.CEKWithCost.html#1450" class="Function">spend</a> <a id="3570" href="Cost.Base.html#968" class="InductiveConstructor">BBuiltin</a>
    <a id="3583" href="Utils.html#2879" class="Field">return</a> <a id="3590" class="Symbol">(</a><a id="3591" href="Untyped.CEKWithCost.html#3527" class="Bound">s</a> <a id="3593" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="3595" href="Untyped.CEK.html#18313" class="Function">ival</a> <a id="3600" href="Untyped.CEKWithCost.html#3543" class="Bound">b</a><a id="3601" class="Symbol">)</a>
<a id="3603" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3609" class="Symbol">(</a><a id="3610" href="Untyped.CEKWithCost.html#3610" class="Bound">s</a> <a id="3612" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3614" href="Untyped.CEKWithCost.html#3614" class="Bound">ρ</a> <a id="3616" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3618" href="Untyped.html#1573" class="InductiveConstructor">error</a><a id="3623" class="Symbol">)</a>             <a id="3637" class="Symbol">=</a> <a id="3639" href="Utils.html#2879" class="Field">return</a> <a id="3646" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a>

<a id="3649" class="Comment">-- return∁EK in the Haskell implementation</a>
<a id="3692" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3698" class="Symbol">(</a><a id="3699" href="Untyped.CEK.html#1168" class="InductiveConstructor">ε</a> <a id="3701" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="3703" href="Untyped.CEKWithCost.html#3703" class="Bound">v</a><a id="3704" class="Symbol">)</a>                               <a id="3736" class="Symbol">=</a> <a id="3738" href="Utils.html#2879" class="Field">return</a> <a id="3745" class="Symbol">(</a><a id="3746" href="Untyped.CEK.html#3621" class="InductiveConstructor">□</a> <a id="3748" href="Untyped.CEKWithCost.html#3703" class="Bound">v</a><a id="3749" class="Symbol">)</a>
<a id="3751" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3757" class="Symbol">((</a><a id="3759" href="Untyped.CEKWithCost.html#3759" class="Bound">s</a> <a id="3761" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="3763" href="Untyped.CEK.html#3290" class="InductiveConstructor">-·</a> <a id="3766" href="Untyped.CEKWithCost.html#3766" class="Bound">ρ</a> <a id="3768" href="Untyped.CEKWithCost.html#3768" class="Bound">u</a><a id="3769" class="Symbol">)</a> <a id="3771" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="3773" href="Untyped.CEKWithCost.html#3773" class="Bound">v</a><a id="3774" class="Symbol">)</a>                    <a id="3795" class="Symbol">=</a> <a id="3797" href="Utils.html#2879" class="Field">return</a> <a id="3804" class="Symbol">((</a><a id="3806" href="Untyped.CEKWithCost.html#3759" class="Bound">s</a> <a id="3808" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="3810" class="Symbol">(</a><a id="3811" href="Untyped.CEKWithCost.html#3773" class="Bound">v</a> <a id="3813" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="3815" class="Symbol">))</a> <a id="3818" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3820" href="Untyped.CEKWithCost.html#3766" class="Bound">ρ</a> <a id="3822" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3824" href="Untyped.CEKWithCost.html#3768" class="Bound">u</a><a id="3825" class="Symbol">)</a>
<a id="3827" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3833" class="Symbol">((</a><a id="3835" href="Untyped.CEKWithCost.html#3835" class="Bound">s</a> <a id="3837" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="3839" href="Untyped.CEK.html#3325" class="InductiveConstructor">-·v</a> <a id="3843" href="Untyped.CEKWithCost.html#3843" class="Bound">v</a><a id="3844" class="Symbol">)</a> <a id="3846" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="3848" href="Untyped.CEKWithCost.html#3848" class="Bound">vf</a><a id="3850" class="Symbol">)</a>                    <a id="3871" class="Symbol">=</a> <a id="3873" href="Utils.html#2879" class="Field">return</a> <a id="3880" class="Symbol">((</a><a id="3882" href="Untyped.CEKWithCost.html#3835" class="Bound">s</a> <a id="3884" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="3886" href="Untyped.CEKWithCost.html#3848" class="Bound">vf</a> <a id="3889" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="3891" class="Symbol">)</a> <a id="3893" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="3895" href="Untyped.CEKWithCost.html#3843" class="Bound">v</a><a id="3896" class="Symbol">)</a>
<a id="3898" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3904" class="Symbol">((</a><a id="3906" href="Untyped.CEKWithCost.html#3906" class="Bound">s</a> <a id="3908" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="3910" class="Symbol">(</a><a id="3911" href="Untyped.CEK.html#1452" class="InductiveConstructor">V-ƛ</a> <a id="3915" href="Untyped.CEKWithCost.html#3915" class="Bound">ρ</a> <a id="3917" href="Untyped.CEKWithCost.html#3917" class="Bound">t</a> <a id="3919" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="3921" class="Symbol">))</a> <a id="3924" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="3926" href="Untyped.CEKWithCost.html#3926" class="Bound">v</a><a id="3927" class="Symbol">)</a>              <a id="3942" class="Symbol">=</a> <a id="3944" href="Utils.html#2879" class="Field">return</a> <a id="3951" class="Symbol">(</a><a id="3952" href="Untyped.CEKWithCost.html#3906" class="Bound">s</a> <a id="3954" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="3956" href="Untyped.CEKWithCost.html#3915" class="Bound">ρ</a> <a id="3958" href="Untyped.CEK.html#1278" class="InductiveConstructor Operator">∷</a> <a id="3960" href="Untyped.CEKWithCost.html#3926" class="Bound">v</a> <a id="3962" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="3964" href="Untyped.CEKWithCost.html#3917" class="Bound">t</a><a id="3965" class="Symbol">)</a>
<a id="3967" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="3973" class="Symbol">((</a><a id="3975" href="Untyped.CEKWithCost.html#3975" class="Bound">s</a> <a id="3977" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="3979" class="Symbol">(</a><a id="3980" href="Untyped.CEK.html#1493" class="InductiveConstructor">V-con</a> <a id="3986" class="Symbol">_</a> <a id="3988" class="Symbol">_</a>   <a id="3992" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="3994" class="Symbol">))</a> <a id="3997" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="3999" href="Untyped.CEKWithCost.html#3999" class="Bound">v</a><a id="4000" class="Symbol">)</a>          <a id="4011" class="Symbol">=</a> <a id="4013" href="Utils.html#2879" class="Field">return</a> <a id="4020" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="4022" class="Comment">-- constant in function position</a>
<a id="4055" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="4061" class="Symbol">((</a><a id="4063" href="Untyped.CEKWithCost.html#4063" class="Bound">s</a> <a id="4065" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="4067" class="Symbol">(</a><a id="4068" href="Untyped.CEK.html#1536" class="InductiveConstructor">V-delay</a> <a id="4076" class="Symbol">_</a> <a id="4078" class="Symbol">_</a> <a id="4080" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="4082" class="Symbol">))</a> <a id="4085" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="4087" href="Untyped.CEKWithCost.html#4087" class="Bound">v</a><a id="4088" class="Symbol">)</a>          <a id="4099" class="Symbol">=</a> <a id="4101" href="Utils.html#2879" class="Field">return</a> <a id="4108" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="4110" class="Comment">-- delay in function position</a>
<a id="4140" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="4146" class="Symbol">((</a><a id="4148" href="Untyped.CEKWithCost.html#4148" class="Bound">s</a> <a id="4150" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="4152" class="Symbol">(</a><a id="4153" href="Untyped.CEK.html#1784" class="InductiveConstructor">V-IΠ</a> <a id="4158" href="Untyped.CEKWithCost.html#4158" class="Bound">b</a> <a id="4160" href="Untyped.CEKWithCost.html#4160" class="Bound">bapp</a> <a id="4165" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="4167" class="Symbol">))</a> <a id="4170" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="4172" href="Untyped.CEKWithCost.html#4172" class="Bound">v</a><a id="4173" class="Symbol">)</a>          <a id="4184" class="Symbol">=</a> <a id="4186" href="Utils.html#2879" class="Field">return</a> <a id="4193" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="4195" class="Comment">-- delayed builtin in function position</a>
<a id="4235" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="4241" class="Symbol">((</a><a id="4243" href="Untyped.CEKWithCost.html#4243" class="Bound">s</a> <a id="4245" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="4247" class="Symbol">(</a><a id="4248" href="Untyped.CEK.html#1575" class="InductiveConstructor">V-constr</a> <a id="4257" href="Untyped.CEKWithCost.html#4257" class="Bound">i</a> <a id="4259" href="Untyped.CEKWithCost.html#4259" class="Bound">vs</a> <a id="4262" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="4264" class="Symbol">))</a> <a id="4267" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="4269" href="Untyped.CEKWithCost.html#4269" class="Bound">v</a><a id="4270" class="Symbol">)</a>        <a id="4279" class="Symbol">=</a> <a id="4281" href="Utils.html#2879" class="Field">return</a> <a id="4288" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="4290" class="Comment">-- SOP in function position</a>
<a id="4318" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="4324" class="Symbol">((</a><a id="4326" href="Untyped.CEKWithCost.html#4326" class="Bound">s</a> <a id="4328" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="4330" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="4336" class="Symbol">)</a> <a id="4338" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="4340" href="Untyped.CEK.html#1784" class="InductiveConstructor">V-IΠ</a> <a id="4345" href="Untyped.CEKWithCost.html#4345" class="Bound">b</a> <a id="4347" href="Untyped.CEKWithCost.html#4347" class="Bound">bapp</a><a id="4351" class="Symbol">)</a>          <a id="4362" class="Symbol">=</a> <a id="4364" href="Utils.html#2879" class="Field">return</a> <a id="4371" class="Symbol">(</a><a id="4372" href="Untyped.CEKWithCost.html#4326" class="Bound">s</a> <a id="4374" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="4376" href="Untyped.CEK.html#3807" class="Function">V-I</a> <a id="4380" href="Untyped.CEKWithCost.html#4345" class="Bound">b</a> <a id="4382" class="Symbol">(</a><a id="4383" href="Untyped.CEK.html#2211" class="InductiveConstructor">app⋆</a> <a id="4388" href="Untyped.CEKWithCost.html#4347" class="Bound">bapp</a><a id="4392" class="Symbol">))</a>
<a id="4395" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="4401" class="Symbol">((</a><a id="4403" href="Untyped.CEKWithCost.html#4403" class="Bound">s</a> <a id="4405" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="4407" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="4413" class="Symbol">)</a> <a id="4415" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="4417" href="Untyped.CEK.html#1536" class="InductiveConstructor">V-delay</a> <a id="4425" href="Untyped.CEKWithCost.html#4425" class="Bound">ρ</a> <a id="4427" href="Untyped.CEKWithCost.html#4427" class="Bound">t</a><a id="4428" class="Symbol">)</a>          <a id="4439" class="Symbol">=</a> <a id="4441" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="4447" class="Symbol">(</a><a id="4448" href="Untyped.CEKWithCost.html#4403" class="Bound">s</a> <a id="4450" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="4452" href="Untyped.CEKWithCost.html#4425" class="Bound">ρ</a> <a id="4454" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="4456" href="Untyped.CEKWithCost.html#4427" class="Bound">t</a><a id="4457" class="Symbol">)</a> <a id="4459" class="Comment">-- this recursive call could be inlined</a>
                                                                <a id="4563" class="Comment">-- in order to make evident that this is a single step </a>
                                                                <a id="4683" class="Comment">-- but this would make the definition much longer.</a>
<a id="4734" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="4740" class="Symbol">((</a><a id="4742" href="Untyped.CEKWithCost.html#4742" class="Bound">s</a> <a id="4744" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="4746" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="4752" class="Symbol">)</a> <a id="4754" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="4756" href="Untyped.CEK.html#1452" class="InductiveConstructor">V-ƛ</a> <a id="4760" class="Symbol">_</a> <a id="4762" class="Symbol">_)</a>              <a id="4778" class="Symbol">=</a> <a id="4780" href="Utils.html#2879" class="Field">return</a> <a id="4787" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="4789" class="Comment">-- lambda in delay position</a>
<a id="4817" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="4823" class="Symbol">((</a><a id="4825" href="Untyped.CEKWithCost.html#4825" class="Bound">s</a> <a id="4827" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="4829" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="4835" class="Symbol">)</a> <a id="4837" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="4839" href="Untyped.CEK.html#1493" class="InductiveConstructor">V-con</a> <a id="4845" class="Symbol">_</a> <a id="4847" class="Symbol">_)</a>            <a id="4861" class="Symbol">=</a> <a id="4863" href="Utils.html#2879" class="Field">return</a> <a id="4870" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="4872" class="Comment">-- constant in delay position</a>
<a id="4902" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="4908" class="Symbol">((</a><a id="4910" href="Untyped.CEKWithCost.html#4910" class="Bound">s</a> <a id="4912" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="4914" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="4920" class="Symbol">)</a> <a id="4922" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="4924" href="Untyped.CEK.html#1625" class="InductiveConstructor">V-I⇒</a> <a id="4929" href="Untyped.CEKWithCost.html#4929" class="Bound">b</a> <a id="4931" href="Untyped.CEKWithCost.html#4931" class="Bound">bapp</a><a id="4935" class="Symbol">)</a>          <a id="4946" class="Symbol">=</a> <a id="4948" href="Utils.html#2879" class="Field">return</a> <a id="4955" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="4957" class="Comment">-- function in delay position</a>
<a id="4987" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="4993" class="Symbol">((</a><a id="4995" href="Untyped.CEKWithCost.html#4995" class="Bound">s</a> <a id="4997" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="4999" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="5005" class="Symbol">)</a> <a id="5007" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="5009" href="Untyped.CEK.html#1575" class="InductiveConstructor">V-constr</a> <a id="5018" href="Untyped.CEKWithCost.html#5018" class="Bound">i</a> <a id="5020" href="Untyped.CEKWithCost.html#5020" class="Bound">vs</a><a id="5022" class="Symbol">)</a>        <a id="5031" class="Symbol">=</a> <a id="5033" href="Utils.html#2879" class="Field">return</a> <a id="5040" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="5042" class="Comment">-- SOP in delay position</a>
<a id="5067" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="5073" class="Symbol">((</a><a id="5075" href="Untyped.CEKWithCost.html#5075" class="Bound">s</a> <a id="5077" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5079" href="Untyped.CEK.html#3386" class="InductiveConstructor">constr-</a> <a id="5087" href="Untyped.CEKWithCost.html#5087" class="Bound">i</a> <a id="5089" href="Untyped.CEKWithCost.html#5089" class="Bound">vs</a> <a id="5092" href="Untyped.CEKWithCost.html#5092" class="Bound">ρ</a> <a id="5094" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5096" class="Symbol">)</a> <a id="5098" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="5100" href="Untyped.CEKWithCost.html#5100" class="Bound">v</a><a id="5101" class="Symbol">)</a>         <a id="5111" class="Symbol">=</a> <a id="5113" href="Utils.html#2879" class="Field">return</a> <a id="5120" class="Symbol">(</a><a id="5121" href="Untyped.CEKWithCost.html#5075" class="Bound">s</a> <a id="5123" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="5125" href="Untyped.CEK.html#1575" class="InductiveConstructor">V-constr</a> <a id="5134" href="Untyped.CEKWithCost.html#5087" class="Bound">i</a> <a id="5136" class="Symbol">(</a><a id="5137" href="Untyped.CEKWithCost.html#5089" class="Bound">vs</a> <a id="5140" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5142" href="Untyped.CEKWithCost.html#5100" class="Bound">v</a><a id="5143" class="Symbol">))</a>
<a id="5146" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="5152" class="Symbol">((</a><a id="5154" href="Untyped.CEKWithCost.html#5154" class="Bound">s</a> <a id="5156" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5158" href="Untyped.CEK.html#3386" class="InductiveConstructor">constr-</a> <a id="5166" href="Untyped.CEKWithCost.html#5166" class="Bound">i</a> <a id="5168" href="Untyped.CEKWithCost.html#5168" class="Bound">vs</a> <a id="5171" href="Untyped.CEKWithCost.html#5171" class="Bound">ρ</a> <a id="5173" class="Symbol">(</a><a id="5174" href="Untyped.CEKWithCost.html#5174" class="Bound">x</a> <a id="5176" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5178" href="Untyped.CEKWithCost.html#5178" class="Bound">ts</a><a id="5180" class="Symbol">))</a> <a id="5183" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="5185" href="Untyped.CEKWithCost.html#5185" class="Bound">v</a><a id="5186" class="Symbol">)</a>   <a id="5190" class="Symbol">=</a> <a id="5192" href="Utils.html#2879" class="Field">return</a> <a id="5199" class="Symbol">((</a><a id="5201" href="Untyped.CEKWithCost.html#5154" class="Bound">s</a> <a id="5203" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5205" href="Untyped.CEK.html#3386" class="InductiveConstructor">constr-</a> <a id="5213" href="Untyped.CEKWithCost.html#5166" class="Bound">i</a> <a id="5215" class="Symbol">(</a><a id="5216" href="Untyped.CEKWithCost.html#5168" class="Bound">vs</a> <a id="5219" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5221" href="Untyped.CEKWithCost.html#5185" class="Bound">v</a><a id="5222" class="Symbol">)</a> <a id="5224" href="Untyped.CEKWithCost.html#5171" class="Bound">ρ</a> <a id="5226" href="Untyped.CEKWithCost.html#5178" class="Bound">ts</a><a id="5228" class="Symbol">)</a><a id="5229" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="5231" href="Untyped.CEKWithCost.html#5171" class="Bound">ρ</a> <a id="5233" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="5235" href="Untyped.CEKWithCost.html#5174" class="Bound">x</a><a id="5236" class="Symbol">)</a>
<a id="5238" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="5244" class="Symbol">((</a><a id="5246" href="Untyped.CEKWithCost.html#5246" class="Bound">s</a> <a id="5248" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5250" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="5256" href="Untyped.CEKWithCost.html#5256" class="Bound">ρ</a> <a id="5258" href="Untyped.CEKWithCost.html#5258" class="Bound">ts</a><a id="5260" class="Symbol">)</a> <a id="5262" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="5264" href="Untyped.CEK.html#1575" class="InductiveConstructor">V-constr</a> <a id="5273" href="Untyped.CEKWithCost.html#5273" class="Bound">i</a> <a id="5275" href="Untyped.CEKWithCost.html#5275" class="Bound">vs</a><a id="5277" class="Symbol">)</a>    <a id="5282" class="Symbol">=</a> <a id="5284" href="Utils.html#2879" class="Field">return</a> <a id="5291" class="Symbol">(</a><a id="5292" href="Data.Maybe.Base.html#1371" class="Function">maybe</a> <a id="5298" class="Symbol">(</a><a id="5299" href="Untyped.CEK.html#18357" class="Function">pushValueFrames</a> <a id="5315" href="Untyped.CEKWithCost.html#5246" class="Bound">s</a> <a id="5317" href="Untyped.CEKWithCost.html#5275" class="Bound">vs</a> <a id="5320" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="5322" href="Untyped.CEKWithCost.html#5256" class="Bound">ρ</a> <a id="5324" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻_</a><a id="5326" class="Symbol">)</a> <a id="5328" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="5330" class="Symbol">(</a><a id="5331" href="Untyped.CEK.html#18500" class="Function">lookup?</a> <a id="5339" href="Untyped.CEKWithCost.html#5273" class="Bound">i</a> <a id="5341" href="Untyped.CEKWithCost.html#5258" class="Bound">ts</a><a id="5343" class="Symbol">))</a>
<a id="5346" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="5352" class="Symbol">((</a><a id="5354" href="Untyped.CEKWithCost.html#5354" class="Bound">s</a> <a id="5356" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5358" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="5364" href="Untyped.CEKWithCost.html#5364" class="Bound">ρ</a> <a id="5366" href="Untyped.CEKWithCost.html#5366" class="Bound">ts</a><a id="5368" class="Symbol">)</a> <a id="5370" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="5372" href="Untyped.CEK.html#1452" class="InductiveConstructor">V-ƛ</a> <a id="5376" class="Symbol">_</a> <a id="5378" class="Symbol">_)</a>          <a id="5390" class="Symbol">=</a> <a id="5392" href="Utils.html#2879" class="Field">return</a> <a id="5399" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="5401" class="Comment">-- case of lambda</a>
<a id="5419" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="5425" class="Symbol">((</a><a id="5427" href="Untyped.CEKWithCost.html#5427" class="Bound">s</a> <a id="5429" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5431" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="5437" href="Untyped.CEKWithCost.html#5437" class="Bound">ρ</a> <a id="5439" href="Untyped.CEKWithCost.html#5439" class="Bound">ts</a><a id="5441" class="Symbol">)</a> <a id="5443" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="5445" href="Untyped.CEK.html#1493" class="InductiveConstructor">V-con</a> <a id="5451" class="Symbol">_</a> <a id="5453" class="Symbol">_)</a>        <a id="5463" class="Symbol">=</a> <a id="5465" href="Utils.html#2879" class="Field">return</a> <a id="5472" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="5474" class="Comment">-- case of constant</a>
<a id="5494" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="5500" class="Symbol">((</a><a id="5502" href="Untyped.CEKWithCost.html#5502" class="Bound">s</a> <a id="5504" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5506" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="5512" href="Untyped.CEKWithCost.html#5512" class="Bound">ρ</a> <a id="5514" href="Untyped.CEKWithCost.html#5514" class="Bound">ts</a><a id="5516" class="Symbol">)</a> <a id="5518" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="5520" href="Untyped.CEK.html#1536" class="InductiveConstructor">V-delay</a> <a id="5528" class="Symbol">_</a> <a id="5530" class="Symbol">_)</a>      <a id="5538" class="Symbol">=</a> <a id="5540" href="Utils.html#2879" class="Field">return</a> <a id="5547" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="5549" class="Comment">-- case of delay</a>
<a id="5566" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="5572" class="Symbol">((</a><a id="5574" href="Untyped.CEKWithCost.html#5574" class="Bound">s</a> <a id="5576" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5578" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="5584" href="Untyped.CEKWithCost.html#5584" class="Bound">ρ</a> <a id="5586" href="Untyped.CEKWithCost.html#5586" class="Bound">ts</a><a id="5588" class="Symbol">)</a> <a id="5590" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="5592" href="Untyped.CEK.html#1625" class="InductiveConstructor">V-I⇒</a> <a id="5597" class="Symbol">_</a> <a id="5599" class="Symbol">_)</a>         <a id="5610" class="Symbol">=</a> <a id="5612" href="Utils.html#2879" class="Field">return</a> <a id="5619" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="5621" class="Comment">-- case of builtin value</a>
<a id="5646" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="5652" class="Symbol">((</a><a id="5654" href="Untyped.CEKWithCost.html#5654" class="Bound">s</a> <a id="5656" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5658" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="5664" href="Untyped.CEKWithCost.html#5664" class="Bound">ρ</a> <a id="5666" href="Untyped.CEKWithCost.html#5666" class="Bound">ts</a><a id="5668" class="Symbol">)</a> <a id="5670" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="5672" href="Untyped.CEK.html#1784" class="InductiveConstructor">V-IΠ</a> <a id="5677" class="Symbol">_</a> <a id="5679" class="Symbol">_)</a>         <a id="5690" class="Symbol">=</a> <a id="5692" href="Utils.html#2879" class="Field">return</a> <a id="5699" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="5701" class="Comment">-- case of delayed builtin</a>
<a id="5728" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="5734" class="Symbol">((</a><a id="5736" href="Untyped.CEKWithCost.html#5736" class="Bound">s</a> <a id="5738" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="5740" class="Symbol">(</a><a id="5741" href="Untyped.CEK.html#1625" class="InductiveConstructor">V-I⇒</a> <a id="5746" href="Untyped.CEKWithCost.html#5746" class="Bound">b</a> <a id="5748" class="Symbol">{</a><a id="5749" class="Argument">am</a> <a id="5752" class="Symbol">=</a> <a id="5754" class="Number">0</a><a id="5755" class="Symbol">}</a> <a id="5757" href="Untyped.CEKWithCost.html#5757" class="Bound">bapp</a> <a id="5762" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="5764" class="Symbol">))</a> <a id="5767" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="5769" href="Untyped.CEKWithCost.html#5769" class="Bound">v</a><a id="5770" class="Symbol">)</a> <a id="5772" class="Symbol">=</a> <a id="5774" class="Keyword">do</a> <a id="5777" class="Comment">--fully applied builtin function</a>
          <a id="5820" class="Keyword">let</a> <a id="5824" href="Untyped.CEKWithCost.html#5824" class="Bound">bapp&#39;</a> <a id="5830" class="Symbol">=</a> <a id="5832" href="Untyped.CEK.html#17673" class="Function">mkFullyAppliedBuiltin</a> <a id="5854" class="Symbol">(</a><a id="5855" href="Untyped.CEK.html#2043" class="InductiveConstructor">app</a> <a id="5859" href="Untyped.CEKWithCost.html#5757" class="Bound">bapp</a> <a id="5864" href="Untyped.CEKWithCost.html#5769" class="Bound">v</a><a id="5865" class="Symbol">)</a> <a id="5867" class="Comment">-- proof that b is fully applied</a>
          <a id="5910" href="Untyped.CEKWithCost.html#2375" class="Function">spendBuiltin</a> <a id="5923" href="Untyped.CEKWithCost.html#5746" class="Bound">b</a> <a id="5925" href="Untyped.CEKWithCost.html#5824" class="Bound">bapp&#39;</a> 
          <a id="5942" href="Utils.html#2879" class="Field">return</a> <a id="5949" class="Symbol">(</a><a id="5950" href="Utils.html#1229" class="Function">either</a> <a id="5957" class="Symbol">(</a><a id="5958" href="Untyped.CEK.html#4224" class="Function">BUILTIN</a> <a id="5966" href="Untyped.CEKWithCost.html#5746" class="Bound">b</a> <a id="5968" href="Untyped.CEKWithCost.html#5824" class="Bound">bapp&#39;</a><a id="5973" class="Symbol">)</a> <a id="5975" class="Symbol">(λ</a> <a id="5978" href="Untyped.CEKWithCost.html#5978" class="Bound">_</a> <a id="5980" class="Symbol">→</a>  <a id="5983" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a><a id="5984" class="Symbol">)</a> <a id="5986" class="Symbol">(</a><a id="5987" href="Untyped.CEKWithCost.html#5736" class="Bound">s</a> <a id="5989" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅_</a><a id="5991" class="Symbol">))</a>
<a id="5994" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="6000" class="Symbol">((</a><a id="6002" href="Untyped.CEKWithCost.html#6002" class="Bound">s</a> <a id="6004" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="6006" class="Symbol">(</a><a id="6007" href="Untyped.CEK.html#1625" class="InductiveConstructor">V-I⇒</a> <a id="6012" href="Untyped.CEKWithCost.html#6012" class="Bound">b</a> <a id="6014" class="Symbol">{</a><a id="6015" class="Argument">am</a> <a id="6018" class="Symbol">=</a> <a id="6020" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="6024" class="Symbol">_}</a> <a id="6027" href="Untyped.CEKWithCost.html#6027" class="Bound">bapp</a> <a id="6032" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="6034" class="Symbol">))</a> <a id="6037" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="6039" href="Untyped.CEKWithCost.html#6039" class="Bound">v</a><a id="6040" class="Symbol">)</a> <a id="6042" class="Symbol">=</a>  <a id="6045" class="Comment">--partially applied builtin function</a>
          <a id="6092" href="Utils.html#2879" class="Field">return</a> <a id="6099" class="Symbol">(</a><a id="6100" href="Untyped.CEKWithCost.html#6002" class="Bound">s</a> <a id="6102" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="6104" href="Untyped.CEK.html#3807" class="Function">V-I</a> <a id="6108" href="Untyped.CEKWithCost.html#6012" class="Bound">b</a> <a id="6110" class="Symbol">(</a><a id="6111" href="Untyped.CEK.html#2043" class="InductiveConstructor">app</a> <a id="6115" href="Untyped.CEKWithCost.html#6027" class="Bound">bapp</a> <a id="6120" href="Untyped.CEKWithCost.html#6039" class="Bound">v</a><a id="6121" class="Symbol">))</a>

<a id="6125" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="6131" class="Symbol">(</a><a id="6132" href="Untyped.CEK.html#3621" class="InductiveConstructor">□</a> <a id="6134" href="Untyped.CEKWithCost.html#6134" class="Bound">v</a><a id="6135" class="Symbol">)</a>               <a id="6151" class="Symbol">=</a> <a id="6153" href="Utils.html#2879" class="Field">return</a> <a id="6160" class="Symbol">(</a><a id="6161" href="Untyped.CEK.html#3621" class="InductiveConstructor">□</a> <a id="6163" href="Untyped.CEKWithCost.html#6134" class="Bound">v</a><a id="6164" class="Symbol">)</a>
<a id="6166" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="6172" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a>                   <a id="6192" class="Symbol">=</a> <a id="6194" href="Utils.html#2879" class="Field">return</a> <a id="6201" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a>

<a id="stepperC-internal"></a><a id="6204" href="Untyped.CEKWithCost.html#6204" class="Function">stepperC-internal</a> <a id="6222" class="Symbol">:</a> <a id="6224" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6226" class="Symbol">→</a> <a id="6228" class="Symbol">(</a><a id="6229" href="Untyped.CEKWithCost.html#6229" class="Bound">s</a> <a id="6231" class="Symbol">:</a> <a id="6233" href="Untyped.CEK.html#3507" class="Datatype">State</a><a id="6238" class="Symbol">)</a> <a id="6240" class="Symbol">→</a> <a id="6242" href="Untyped.CEKWithCost.html#1058" class="Function">CekM</a> <a id="6247" class="Symbol">(</a><a id="6248" href="Utils.html#1092" class="Datatype">Either</a> <a id="6255" href="Utils.html#4328" class="Datatype">RuntimeError</a> <a id="6268" href="Untyped.CEK.html#3507" class="Datatype">State</a><a id="6273" class="Symbol">)</a>
<a id="6275" href="Untyped.CEKWithCost.html#6204" class="Function">stepperC-internal</a> <a id="6293" class="Number">0</a>       <a id="6301" href="Untyped.CEKWithCost.html#6301" class="Bound">s</a> <a id="6303" class="Symbol">=</a> <a id="6305" href="Utils.html#2879" class="Field">return</a> <a id="6312" class="Symbol">(</a><a id="6313" href="Utils.html#1125" class="InductiveConstructor">inj₁</a> <a id="6318" href="Utils.html#4355" class="InductiveConstructor">gasError</a><a id="6326" class="Symbol">)</a>
<a id="6328" href="Untyped.CEKWithCost.html#6204" class="Function">stepperC-internal</a> <a id="6346" class="Symbol">(</a><a id="6347" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="6351" href="Untyped.CEKWithCost.html#6351" class="Bound">n</a><a id="6352" class="Symbol">)</a> <a id="6354" href="Untyped.CEKWithCost.html#6354" class="Bound">s</a> <a id="6356" class="Symbol">=</a> <a id="6358" class="Keyword">do</a>
       <a id="6368" href="Untyped.CEKWithCost.html#6368" class="Bound">s&#39;</a> <a id="6371" href="Utils.html#2907" class="Field Operator">←</a> <a id="6373" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="6379" href="Untyped.CEKWithCost.html#6354" class="Bound">s</a> 
       <a id="6389" href="Untyped.CEKWithCost.html#6412" class="Function">go</a> <a id="6392" href="Untyped.CEKWithCost.html#6368" class="Bound">s&#39;</a>
    <a id="6399" class="Keyword">where</a>
       <a id="6412" href="Untyped.CEKWithCost.html#6412" class="Function">go</a> <a id="6415" class="Symbol">:</a> <a id="6417" class="Symbol">(</a><a id="6418" href="Untyped.CEKWithCost.html#6418" class="Bound">t</a> <a id="6420" class="Symbol">:</a> <a id="6422" href="Untyped.CEK.html#3507" class="Datatype">State</a><a id="6427" class="Symbol">)</a> <a id="6429" class="Symbol">→</a> <a id="6431" href="Untyped.CEKWithCost.html#1058" class="Function">CekM</a> <a id="6436" class="Symbol">(</a><a id="6437" href="Utils.html#1092" class="Datatype">Either</a> <a id="6444" href="Utils.html#4328" class="Datatype">RuntimeError</a> <a id="6457" href="Untyped.CEK.html#3507" class="Datatype">State</a><a id="6462" class="Symbol">)</a>
       <a id="6471" href="Untyped.CEKWithCost.html#6412" class="Function">go</a> <a id="6474" class="Symbol">(</a><a id="6475" href="Untyped.CEK.html#3621" class="InductiveConstructor">□</a> <a id="6477" href="Untyped.CEKWithCost.html#6477" class="Bound">v</a><a id="6478" class="Symbol">)</a> <a id="6480" class="Symbol">=</a> <a id="6482" href="Utils.html#2879" class="Field">return</a> <a id="6489" class="Symbol">(</a><a id="6490" href="Utils.html#1149" class="InductiveConstructor">inj₂</a> <a id="6495" class="Symbol">(</a><a id="6496" href="Untyped.CEK.html#3621" class="InductiveConstructor">□</a> <a id="6498" href="Untyped.CEKWithCost.html#6477" class="Bound">v</a><a id="6499" class="Symbol">))</a>
       <a id="6509" href="Untyped.CEKWithCost.html#6412" class="Function">go</a> <a id="6512" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a>     <a id="6518" class="Symbol">=</a> <a id="6520" href="Utils.html#2879" class="Field">return</a> <a id="6527" class="Symbol">(</a><a id="6528" href="Utils.html#1149" class="InductiveConstructor">inj₂</a> <a id="6533" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a><a id="6534" class="Symbol">)</a>
       <a id="6543" href="Untyped.CEKWithCost.html#6412" class="CatchallClause Function">go</a><a id="6545" class="CatchallClause"> </a><a id="6546" href="Untyped.CEKWithCost.html#6546" class="CatchallClause Bound">s&#39;</a>    <a id="6552" class="Symbol">=</a> <a id="6554" href="Untyped.CEKWithCost.html#6204" class="Function">stepperC-internal</a> <a id="6572" href="Untyped.CEKWithCost.html#6351" class="Bound">n</a> <a id="6574" href="Untyped.CEKWithCost.html#6546" class="Bound">s&#39;</a>

<a id="stepperC"></a><a id="6578" href="Untyped.CEKWithCost.html#6578" class="Function">stepperC</a> <a id="6587" class="Symbol">:</a> <a id="6589" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6591" class="Symbol">→</a> <a id="6593" class="Symbol">(</a><a id="6594" href="Untyped.CEKWithCost.html#6594" class="Bound">s</a> <a id="6596" class="Symbol">:</a> <a id="6598" href="Untyped.CEK.html#3507" class="Datatype">State</a><a id="6603" class="Symbol">)</a> <a id="6605" class="Symbol">→</a> <a id="6607" href="Untyped.CEKWithCost.html#1058" class="Function">CekM</a> <a id="6612" class="Symbol">(</a><a id="6613" href="Utils.html#1092" class="Datatype">Either</a> <a id="6620" href="Utils.html#4328" class="Datatype">RuntimeError</a> <a id="6633" href="Untyped.CEK.html#3507" class="Datatype">State</a><a id="6638" class="Symbol">)</a>
<a id="6640" href="Untyped.CEKWithCost.html#6578" class="Function">stepperC</a> <a id="6649" href="Untyped.CEKWithCost.html#6649" class="Bound">n</a> <a id="6651" href="Untyped.CEKWithCost.html#6651" class="Bound">s</a> <a id="6653" class="Symbol">=</a> <a id="6655" class="Keyword">do</a> 
       <a id="6666" href="Untyped.CEKWithCost.html#1521" class="Function">spendStartupCost</a> 
       <a id="6691" href="Untyped.CEKWithCost.html#6204" class="Function">stepperC-internal</a> <a id="6709" href="Untyped.CEKWithCost.html#6649" class="Bound">n</a> <a id="6711" href="Untyped.CEKWithCost.html#6651" class="Bound">s</a>
</pre>
## Proof of equivalence between CEK machine with and without costs

<pre class="Agda"><a id="cekStepEquivalence"></a><a id="6790" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="6809" class="Symbol">:</a> <a id="6811" class="Symbol">∀</a> <a id="6813" class="Symbol">(</a><a id="6814" href="Untyped.CEKWithCost.html#6814" class="Bound">s</a> <a id="6816" class="Symbol">:</a> <a id="6818" href="Untyped.CEK.html#3507" class="Datatype">State</a><a id="6823" class="Symbol">)</a> <a id="6825" class="Symbol">→</a> <a id="6827" href="Untyped.CEK.html#18633" class="Function">step</a> <a id="6832" href="Untyped.CEKWithCost.html#6814" class="Bound">s</a> <a id="6834" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6836" href="Utils.html#3989" class="Field">wrvalue</a> <a id="6844" class="Symbol">(</a><a id="6845" href="Untyped.CEKWithCost.html#2649" class="Function">stepC</a> <a id="6851" href="Untyped.CEKWithCost.html#6814" class="Bound">s</a><a id="6852" class="Symbol">)</a> 
<a id="6855" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="6874" class="Symbol">(</a><a id="6875" href="Untyped.CEKWithCost.html#6875" class="Bound">s</a> <a id="6877" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="6879" href="Untyped.CEKWithCost.html#6879" class="Bound">ρ</a> <a id="6881" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="6883" href="Untyped.html#1322" class="InductiveConstructor">`</a> <a id="6885" class="Symbol">_)</a> <a id="6888" class="Symbol">=</a> <a id="6890" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="6895" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="6914" class="Symbol">(</a><a id="6915" href="Untyped.CEKWithCost.html#6915" class="Bound">s</a> <a id="6917" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="6919" href="Untyped.CEKWithCost.html#6919" class="Bound">ρ</a> <a id="6921" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="6923" href="Untyped.html#1338" class="InductiveConstructor">ƛ</a> <a id="6925" class="Symbol">_)</a> <a id="6928" class="Symbol">=</a> <a id="6930" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="6935" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="6954" class="Symbol">(</a><a id="6955" href="Untyped.CEKWithCost.html#6955" class="Bound">s</a> <a id="6957" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="6959" href="Untyped.CEKWithCost.html#6959" class="Bound">ρ</a> <a id="6961" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="6963" class="Symbol">(_</a> <a id="6966" href="Untyped.html#1362" class="InductiveConstructor Operator">·</a> <a id="6968" class="Symbol">_))</a> <a id="6972" class="Symbol">=</a> <a id="6974" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="6979" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="6998" class="Symbol">(</a><a id="6999" href="Untyped.CEKWithCost.html#6999" class="Bound">s</a> <a id="7001" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="7003" href="Untyped.CEKWithCost.html#7003" class="Bound">ρ</a> <a id="7005" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="7007" href="Untyped.html#1386" class="InductiveConstructor">force</a> <a id="7013" class="Symbol">_)</a> <a id="7016" class="Symbol">=</a> <a id="7018" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7023" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7042" class="Symbol">(</a><a id="7043" href="Untyped.CEKWithCost.html#7043" class="Bound">s</a> <a id="7045" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="7047" href="Untyped.CEKWithCost.html#7047" class="Bound">ρ</a> <a id="7049" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="7051" href="Untyped.html#1406" class="InductiveConstructor">delay</a> <a id="7057" class="Symbol">_)</a> <a id="7060" class="Symbol">=</a> <a id="7062" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7067" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7086" class="Symbol">(</a><a id="7087" href="Untyped.CEKWithCost.html#7087" class="Bound">s</a> <a id="7089" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="7091" href="Untyped.CEKWithCost.html#7091" class="Bound">ρ</a> <a id="7093" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="7095" href="Untyped.html#1426" class="InductiveConstructor">con</a> <a id="7099" class="Symbol">(</a><a id="7100" href="RawU.html#7605" class="InductiveConstructor">tmCon</a> <a id="7106" class="Symbol">_</a> <a id="7108" class="Symbol">_))</a> <a id="7112" class="Symbol">=</a> <a id="7114" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7119" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7138" class="Symbol">(</a><a id="7139" href="Untyped.CEKWithCost.html#7139" class="Bound">s</a> <a id="7141" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="7143" href="Untyped.CEKWithCost.html#7143" class="Bound">ρ</a> <a id="7145" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="7147" href="Untyped.html#1446" class="InductiveConstructor">constr</a> <a id="7154" class="Symbol">_</a> <a id="7156" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="7158" class="Symbol">)</a> <a id="7160" class="Symbol">=</a> <a id="7162" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7167" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7186" class="Symbol">(</a><a id="7187" href="Untyped.CEKWithCost.html#7187" class="Bound">s</a> <a id="7189" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="7191" href="Untyped.CEKWithCost.html#7191" class="Bound">ρ</a> <a id="7193" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="7195" href="Untyped.html#1446" class="InductiveConstructor">constr</a> <a id="7202" class="Symbol">_</a> <a id="7204" class="Symbol">(_</a> <a id="7207" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7209" class="Symbol">_))</a> <a id="7213" class="Symbol">=</a> <a id="7215" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7220" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7239" class="Symbol">(</a><a id="7240" href="Untyped.CEKWithCost.html#7240" class="Bound">s</a> <a id="7242" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="7244" href="Untyped.CEKWithCost.html#7244" class="Bound">ρ</a> <a id="7246" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="7248" href="Untyped.html#1493" class="InductiveConstructor">case</a> <a id="7253" class="Symbol">_</a> <a id="7255" class="Symbol">_)</a> <a id="7258" class="Symbol">=</a> <a id="7260" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7265" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7284" class="Symbol">(</a><a id="7285" href="Untyped.CEKWithCost.html#7285" class="Bound">s</a> <a id="7287" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="7289" href="Untyped.CEKWithCost.html#7289" class="Bound">ρ</a> <a id="7291" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="7293" href="Untyped.html#1541" class="InductiveConstructor">builtin</a> <a id="7301" class="Symbol">_)</a> <a id="7304" class="Symbol">=</a> <a id="7306" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7311" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7330" class="Symbol">(</a><a id="7331" href="Untyped.CEKWithCost.html#7331" class="Bound">s</a> <a id="7333" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="7335" href="Untyped.CEKWithCost.html#7335" class="Bound">ρ</a> <a id="7337" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="7339" href="Untyped.html#1573" class="InductiveConstructor">error</a><a id="7344" class="Symbol">)</a> <a id="7346" class="Symbol">=</a> <a id="7348" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7353" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7372" class="Symbol">(</a><a id="7373" href="Untyped.CEK.html#1168" class="InductiveConstructor">ε</a> <a id="7375" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="7377" class="Symbol">_)</a> <a id="7380" class="Symbol">=</a> <a id="7382" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7387" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7406" class="Symbol">((</a><a id="7408" href="Untyped.CEKWithCost.html#7408" class="Bound">s</a> <a id="7410" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="7412" href="Untyped.CEK.html#3290" class="InductiveConstructor">-·</a> <a id="7415" class="Symbol">_</a> <a id="7417" class="Symbol">_)</a> <a id="7420" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="7422" class="Symbol">_)</a> <a id="7425" class="Symbol">=</a> <a id="7427" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7432" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7451" class="Symbol">((</a><a id="7453" href="Untyped.CEKWithCost.html#7453" class="Bound">s</a> <a id="7455" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="7457" href="Untyped.CEK.html#3325" class="InductiveConstructor">-·v</a> <a id="7461" class="Symbol">_)</a> <a id="7464" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="7466" class="Symbol">_)</a> <a id="7469" class="Symbol">=</a> <a id="7471" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7476" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7495" class="Symbol">((</a><a id="7497" href="Untyped.CEKWithCost.html#7497" class="Bound">s</a> <a id="7499" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="7501" class="Symbol">(</a><a id="7502" href="Untyped.CEK.html#1452" class="InductiveConstructor">V-ƛ</a> <a id="7506" class="Symbol">_</a> <a id="7508" class="Symbol">_</a> <a id="7510" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="7512" class="Symbol">))</a> <a id="7515" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="7517" class="Symbol">_)</a> <a id="7520" class="Symbol">=</a> <a id="7522" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7527" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7546" class="Symbol">((</a><a id="7548" href="Untyped.CEKWithCost.html#7548" class="Bound">s</a> <a id="7550" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="7552" class="Symbol">(</a><a id="7553" href="Untyped.CEK.html#1493" class="InductiveConstructor">V-con</a> <a id="7559" class="Symbol">_</a> <a id="7561" class="Symbol">_</a> <a id="7563" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="7565" class="Symbol">))</a> <a id="7568" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="7570" class="Symbol">_)</a> <a id="7573" class="Symbol">=</a> <a id="7575" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7580" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7599" class="Symbol">((</a><a id="7601" href="Untyped.CEKWithCost.html#7601" class="Bound">s</a> <a id="7603" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="7605" class="Symbol">(</a><a id="7606" href="Untyped.CEK.html#1536" class="InductiveConstructor">V-delay</a> <a id="7614" class="Symbol">_</a> <a id="7616" class="Symbol">_</a> <a id="7618" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="7620" class="Symbol">))</a> <a id="7623" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="7625" class="Symbol">_)</a> <a id="7628" class="Symbol">=</a> <a id="7630" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7635" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7654" class="Symbol">((</a><a id="7656" href="Untyped.CEKWithCost.html#7656" class="Bound">s</a> <a id="7658" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="7660" class="Symbol">(</a><a id="7661" href="Untyped.CEK.html#1575" class="InductiveConstructor">V-constr</a> <a id="7670" class="Symbol">_</a> <a id="7672" class="Symbol">_</a> <a id="7674" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="7676" class="Symbol">))</a> <a id="7679" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="7681" class="Symbol">_)</a> <a id="7684" class="Symbol">=</a> <a id="7686" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7691" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7710" class="Symbol">((</a><a id="7712" href="Untyped.CEKWithCost.html#7712" class="Bound">s</a> <a id="7714" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="7716" class="Symbol">(</a><a id="7717" href="Untyped.CEK.html#1625" class="InductiveConstructor">V-I⇒</a> <a id="7722" href="Untyped.CEKWithCost.html#7722" class="Bound">b</a> <a id="7724" class="Symbol">{</a><a id="7725" class="Argument">am</a> <a id="7728" class="Symbol">=</a> <a id="7730" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="7734" class="Symbol">}</a> <a id="7736" href="Untyped.CEKWithCost.html#7736" class="Bound">x</a> <a id="7738" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="7740" class="Symbol">))</a> <a id="7743" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="7745" href="Untyped.CEKWithCost.html#7745" class="Bound">V</a><a id="7746" class="Symbol">)</a> <a id="7748" class="Keyword">with</a> <a id="7753" href="Untyped.CEK.html#18103" class="Function">BUILTIN&#39;</a> <a id="7762" href="Untyped.CEKWithCost.html#7722" class="Bound">b</a> <a id="7764" class="Symbol">(</a><a id="7765" href="Untyped.CEK.html#2043" class="InductiveConstructor">app</a> <a id="7769" href="Untyped.CEKWithCost.html#7736" class="Bound">x</a> <a id="7771" href="Untyped.CEKWithCost.html#7745" class="Bound">V</a><a id="7772" class="Symbol">)</a>
<a id="7774" class="Symbol">...</a> <a id="7778" class="Symbol">|</a> <a id="7780" href="Utils.html#1125" class="InductiveConstructor">inj₁</a> <a id="7785" class="Symbol">_</a> <a id="7787" class="Symbol">=</a> <a id="7789" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7794" class="Symbol">...</a> <a id="7798" class="Symbol">|</a> <a id="7800" href="Utils.html#1149" class="InductiveConstructor">inj₂</a> <a id="7805" class="Symbol">_</a> <a id="7807" class="Symbol">=</a> <a id="7809" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7814" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7833" class="Symbol">((</a><a id="7835" href="Untyped.CEKWithCost.html#7835" class="Bound">s</a> <a id="7837" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="7839" class="Symbol">(</a><a id="7840" href="Untyped.CEK.html#1625" class="InductiveConstructor">V-I⇒</a> <a id="7845" class="Symbol">_</a> <a id="7847" class="Symbol">{</a><a id="7848" class="Argument">am</a> <a id="7851" class="Symbol">=</a> <a id="7853" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="7857" class="Symbol">_}</a> <a id="7860" class="Symbol">_</a> <a id="7862" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="7864" class="Symbol">))</a> <a id="7867" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="7869" class="Symbol">_)</a> <a id="7872" class="Symbol">=</a> <a id="7874" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7879" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7898" class="Symbol">((</a><a id="7900" href="Untyped.CEKWithCost.html#7900" class="Bound">s</a> <a id="7902" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="7904" class="Symbol">(</a><a id="7905" href="Untyped.CEK.html#1784" class="InductiveConstructor">V-IΠ</a> <a id="7910" class="Symbol">_</a> <a id="7912" class="Symbol">_</a> <a id="7914" href="Untyped.CEK.html#3347" class="InductiveConstructor Operator">·-</a><a id="7916" class="Symbol">))</a> <a id="7919" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="7921" class="Symbol">_)</a> <a id="7924" class="Symbol">=</a> <a id="7926" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7931" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="7950" class="Symbol">((</a><a id="7952" href="Untyped.CEKWithCost.html#7952" class="Bound">s</a> <a id="7954" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="7956" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="7962" class="Symbol">)</a> <a id="7964" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="7966" href="Untyped.CEK.html#1452" class="InductiveConstructor">V-ƛ</a> <a id="7970" class="Symbol">_</a> <a id="7972" class="Symbol">_)</a> <a id="7975" class="Symbol">=</a> <a id="7977" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7982" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8001" class="Symbol">((</a><a id="8003" href="Untyped.CEKWithCost.html#8003" class="Bound">s</a> <a id="8005" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8007" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="8013" class="Symbol">)</a> <a id="8015" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8017" href="Untyped.CEK.html#1493" class="InductiveConstructor">V-con</a> <a id="8023" class="Symbol">_</a> <a id="8025" class="Symbol">_)</a> <a id="8028" class="Symbol">=</a> <a id="8030" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8035" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8054" class="Symbol">((</a><a id="8056" href="Untyped.CEKWithCost.html#8056" class="Bound">s</a> <a id="8058" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8060" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="8066" class="Symbol">)</a> <a id="8068" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8070" href="Untyped.CEK.html#1536" class="InductiveConstructor">V-delay</a> <a id="8078" href="Untyped.CEKWithCost.html#8078" class="Bound">ρ</a> <a id="8080" href="Untyped.CEKWithCost.html#8080" class="Bound">x</a><a id="8081" class="Symbol">)</a> <a id="8083" class="Symbol">=</a> <a id="8085" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8104" class="Symbol">(</a><a id="8105" href="Untyped.CEKWithCost.html#8056" class="Bound">s</a> <a id="8107" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="8109" href="Untyped.CEKWithCost.html#8078" class="Bound">ρ</a> <a id="8111" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="8113" href="Untyped.CEKWithCost.html#8080" class="Bound">x</a><a id="8114" class="Symbol">)</a>
<a id="8116" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8135" class="Symbol">((</a><a id="8137" href="Untyped.CEKWithCost.html#8137" class="Bound">s</a> <a id="8139" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8141" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="8147" class="Symbol">)</a> <a id="8149" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8151" href="Untyped.CEK.html#1575" class="InductiveConstructor">V-constr</a> <a id="8160" class="Symbol">_</a> <a id="8162" class="Symbol">_)</a> <a id="8165" class="Symbol">=</a> <a id="8167" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8172" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8191" class="Symbol">((</a><a id="8193" href="Untyped.CEKWithCost.html#8193" class="Bound">s</a> <a id="8195" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8197" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="8203" class="Symbol">)</a> <a id="8205" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8207" href="Untyped.CEK.html#1625" class="InductiveConstructor">V-I⇒</a> <a id="8212" class="Symbol">_</a> <a id="8214" class="Symbol">_)</a> <a id="8217" class="Symbol">=</a> <a id="8219" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8224" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8243" class="Symbol">((</a><a id="8245" href="Untyped.CEKWithCost.html#8245" class="Bound">s</a> <a id="8247" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8249" href="Untyped.CEK.html#3369" class="InductiveConstructor">force-</a><a id="8255" class="Symbol">)</a> <a id="8257" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8259" href="Untyped.CEK.html#1784" class="InductiveConstructor">V-IΠ</a> <a id="8264" class="Symbol">_</a> <a id="8266" class="Symbol">_)</a> <a id="8269" class="Symbol">=</a> <a id="8271" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8276" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8295" class="Symbol">((</a><a id="8297" href="Untyped.CEKWithCost.html#8297" class="Bound">s</a> <a id="8299" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8301" href="Untyped.CEK.html#3386" class="InductiveConstructor">constr-</a> <a id="8309" class="Symbol">_</a> <a id="8311" class="Symbol">_</a> <a id="8313" class="Symbol">_</a> <a id="8315" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8317" class="Symbol">)</a> <a id="8319" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8321" class="Symbol">_)</a> <a id="8324" class="Symbol">=</a> <a id="8326" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8331" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8350" class="Symbol">((</a><a id="8352" href="Untyped.CEKWithCost.html#8352" class="Bound">s</a> <a id="8354" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8356" href="Untyped.CEK.html#3386" class="InductiveConstructor">constr-</a> <a id="8364" class="Symbol">_</a> <a id="8366" class="Symbol">_</a> <a id="8368" class="Symbol">_</a> <a id="8370" class="Symbol">(_</a> <a id="8373" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8375" class="Symbol">_))</a> <a id="8379" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8381" class="Symbol">_)</a> <a id="8384" class="Symbol">=</a> <a id="8386" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8391" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8410" class="Symbol">((</a><a id="8412" href="Untyped.CEKWithCost.html#8412" class="Bound">s</a> <a id="8414" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8416" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="8422" class="Symbol">_</a> <a id="8424" class="Symbol">_)</a> <a id="8427" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8429" href="Untyped.CEK.html#1452" class="InductiveConstructor">V-ƛ</a> <a id="8433" class="Symbol">_</a> <a id="8435" class="Symbol">_)</a> <a id="8438" class="Symbol">=</a> <a id="8440" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8445" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8464" class="Symbol">((</a><a id="8466" href="Untyped.CEKWithCost.html#8466" class="Bound">s</a> <a id="8468" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8470" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="8476" class="Symbol">_</a> <a id="8478" class="Symbol">_)</a> <a id="8481" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8483" href="Untyped.CEK.html#1493" class="InductiveConstructor">V-con</a> <a id="8489" class="Symbol">_</a> <a id="8491" class="Symbol">_)</a> <a id="8494" class="Symbol">=</a> <a id="8496" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8501" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8520" class="Symbol">((</a><a id="8522" href="Untyped.CEKWithCost.html#8522" class="Bound">s</a> <a id="8524" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8526" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="8532" class="Symbol">_</a> <a id="8534" class="Symbol">_)</a> <a id="8537" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8539" href="Untyped.CEK.html#1536" class="InductiveConstructor">V-delay</a> <a id="8547" class="Symbol">_</a> <a id="8549" class="Symbol">_)</a> <a id="8552" class="Symbol">=</a> <a id="8554" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8559" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8578" class="Symbol">((</a><a id="8580" href="Untyped.CEKWithCost.html#8580" class="Bound">s</a> <a id="8582" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8584" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="8590" class="Symbol">_</a> <a id="8592" class="Symbol">_)</a> <a id="8595" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8597" href="Untyped.CEK.html#1575" class="InductiveConstructor">V-constr</a> <a id="8606" class="Symbol">_</a> <a id="8608" class="Symbol">_)</a> <a id="8611" class="Symbol">=</a> <a id="8613" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8618" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8637" class="Symbol">((</a><a id="8639" href="Untyped.CEKWithCost.html#8639" class="Bound">s</a> <a id="8641" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8643" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="8649" class="Symbol">_</a> <a id="8651" class="Symbol">_)</a> <a id="8654" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8656" href="Untyped.CEK.html#1625" class="InductiveConstructor">V-I⇒</a> <a id="8661" class="Symbol">_</a> <a id="8663" class="Symbol">_)</a> <a id="8666" class="Symbol">=</a> <a id="8668" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8673" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8692" class="Symbol">((</a><a id="8694" href="Untyped.CEKWithCost.html#8694" class="Bound">s</a> <a id="8696" href="Untyped.CEK.html#1182" class="InductiveConstructor Operator">,</a> <a id="8698" href="Untyped.CEK.html#3452" class="InductiveConstructor">case-</a> <a id="8704" class="Symbol">_</a> <a id="8706" class="Symbol">_)</a> <a id="8709" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="8711" href="Untyped.CEK.html#1784" class="InductiveConstructor">V-IΠ</a> <a id="8716" class="Symbol">_</a> <a id="8718" class="Symbol">_)</a> <a id="8721" class="Symbol">=</a> <a id="8723" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8728" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8747" class="Symbol">(</a><a id="8748" href="Untyped.CEK.html#3621" class="InductiveConstructor">□</a> <a id="8750" class="Symbol">_)</a> <a id="8753" class="Symbol">=</a> <a id="8755" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8760" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8779" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="8781" class="Symbol">=</a> <a id="8783" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="cekStepperEquivalence"></a><a id="8789" href="Untyped.CEKWithCost.html#8789" class="Function">cekStepperEquivalence</a> <a id="8811" class="Symbol">:</a> <a id="8813" class="Symbol">∀</a> <a id="8815" href="Untyped.CEKWithCost.html#8815" class="Bound">n</a> <a id="8817" href="Untyped.CEKWithCost.html#8817" class="Bound">s</a> <a id="8819" class="Symbol">→</a> <a id="8821" href="Untyped.CEK.html#21028" class="Function">stepper</a> <a id="8829" href="Untyped.CEKWithCost.html#8815" class="Bound">n</a> <a id="8831" href="Untyped.CEKWithCost.html#8817" class="Bound">s</a> <a id="8833" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="8835" href="Utils.html#3989" class="Field">wrvalue</a> <a id="8843" class="Symbol">(</a><a id="8844" href="Untyped.CEKWithCost.html#6578" class="Function">stepperC</a> <a id="8853" href="Untyped.CEKWithCost.html#8815" class="Bound">n</a> <a id="8855" href="Untyped.CEKWithCost.html#8817" class="Bound">s</a><a id="8856" class="Symbol">)</a> 
<a id="8859" href="Untyped.CEKWithCost.html#8789" class="Function">cekStepperEquivalence</a> <a id="8881" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="8886" href="Untyped.CEKWithCost.html#8886" class="Bound">s</a> <a id="8888" class="Symbol">=</a> <a id="8890" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> 
<a id="8896" href="Untyped.CEKWithCost.html#8789" class="Function">cekStepperEquivalence</a> <a id="8918" class="Symbol">(</a><a id="8919" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8923" href="Untyped.CEKWithCost.html#8923" class="Bound">n</a><a id="8924" class="Symbol">)</a> <a id="8926" href="Untyped.CEKWithCost.html#8926" class="Bound">s</a> <a id="8928" class="Keyword">rewrite</a> <a id="8936" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="8940" class="Symbol">(</a><a id="8941" href="Untyped.CEKWithCost.html#6790" class="Function">cekStepEquivalence</a> <a id="8960" href="Untyped.CEKWithCost.html#8926" class="Bound">s</a><a id="8961" class="Symbol">)</a> <a id="8963" class="Keyword">with</a> <a id="8968" href="Untyped.CEK.html#18633" class="Function">step</a> <a id="8973" href="Untyped.CEKWithCost.html#8926" class="Bound">s</a> 
<a id="8976" class="Symbol">...</a> <a id="8980" class="Symbol">|</a> <a id="8982" href="Untyped.CEKWithCost.html#8982" class="Bound">s</a> <a id="8984" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="8986" href="Untyped.CEKWithCost.html#8986" class="Bound">ρ</a> <a id="8988" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="8990" href="Untyped.CEKWithCost.html#8990" class="Bound">t</a> <a id="8992" class="Symbol">=</a> <a id="8994" href="Untyped.CEKWithCost.html#8789" class="Function">cekStepperEquivalence</a> <a id="9016" class="Bound">n</a> <a id="9018" class="Symbol">(</a><a id="9019" href="Untyped.CEKWithCost.html#8982" class="Bound">s</a> <a id="9021" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">;</a> <a id="9023" href="Untyped.CEKWithCost.html#8986" class="Bound">ρ</a> <a id="9025" href="Untyped.CEK.html#3527" class="InductiveConstructor Operator">▻</a> <a id="9027" href="Untyped.CEKWithCost.html#8990" class="Bound">t</a><a id="9028" class="Symbol">)</a>
<a id="9030" class="Symbol">...</a> <a id="9034" class="Symbol">|</a> <a id="9036" href="Untyped.CEKWithCost.html#9036" class="Bound">s</a> <a id="9038" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="9040" href="Untyped.CEKWithCost.html#9040" class="Bound">v</a> <a id="9042" class="Symbol">=</a> <a id="9044" href="Untyped.CEKWithCost.html#8789" class="Function">cekStepperEquivalence</a> <a id="9066" class="Bound">n</a>  <a id="9069" class="Symbol">(</a><a id="9070" href="Untyped.CEKWithCost.html#9036" class="Bound">s</a> <a id="9072" href="Untyped.CEK.html#3583" class="InductiveConstructor Operator">◅</a> <a id="9074" href="Untyped.CEKWithCost.html#9040" class="Bound">v</a><a id="9075" class="Symbol">)</a>
<a id="9077" class="Symbol">...</a> <a id="9081" class="Symbol">|</a> <a id="9083" href="Untyped.CEK.html#3621" class="InductiveConstructor">□</a> <a id="9085" href="Untyped.CEKWithCost.html#9085" class="Bound">x</a> <a id="9087" class="Symbol">=</a> <a id="9089" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="9094" class="Symbol">...</a> <a id="9098" class="Symbol">|</a> <a id="9100" href="Untyped.CEK.html#3641" class="InductiveConstructor">◆</a> <a id="9102" class="Symbol">=</a> <a id="9104" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
</pre>