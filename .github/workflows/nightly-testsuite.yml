# This workflow runs the nightly plutus-core-test and plutus-ir-test test suite.

name: ci

on:
  schedule:
    - cron: 0 0 * * * # Daily at midnight

  workflow_dispatch: # Or manually dispatch the job
    inputs:
      hedgehog-tests:
        description: argument for --hedgehog-tests
        required: false
        default: "100000"

env: 
  HEDGEHOG_TESTS: ${{ github.event.inputs.hedgehog-tests || 100000 }}

jobs:
  nightly-testsuite:
    name: "ðŸŒ˜ Nightly Test Suite"
    runs-on: [self-hosted, plutus-benchmark]
    steps:
      - name: Checkout
        uses: actions/checkout@main

      - name: Run Plutus Core Test
        run: | 
          pushd plutus-core
          nix run --no-warn-dirty --accept-flake-config .#plutus-core-test -- --hedgehog-tests $HEDGEHOG_TESTS
          popd

      - name: Run Plutus IR Test
        run: |
          pushd plutus-core
          nix run --no-warn-dirty --accept-flake-config .#plutus-ir-test -- --hedgehog-tests $HEDGEHOG_TESTS
          popd
